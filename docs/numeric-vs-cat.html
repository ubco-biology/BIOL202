<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Visualizing association between a numeric and a categorical variable | Tutorials for BIOL202: Introduction to Biostatistics</title>
  <meta name="description" content="All tutorials associated with BIOL202" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Visualizing association between a numeric and a categorical variable | Tutorials for BIOL202: Introduction to Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="All tutorials associated with BIOL202" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Visualizing association between a numeric and a categorical variable | Tutorials for BIOL202: Introduction to Biostatistics" />
  
  <meta name="twitter:description" content="All tutorials associated with BIOL202" />
  

<meta name="author" content="Jason Pither" />


<meta name="date" content="2022-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="two-numeric.html"/>
<link rel="next" href="estimation.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DVMYRT2ND2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DVMYRT2ND2');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOL202 Tutorials</a></li>

<li class="divider"></li>
<li><a href="#part-preface" id="toc-part-preface">(PART*) Preface</a></li>
<li><a href="index.html#welcome" id="toc-welcome">Welcome</a>
<ul>
<li><a href="author.html#author" id="toc-author">Author</a></li>
<li><a href="acknowledgments.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
<li><a href="copyright.html#copyright" id="toc-copyright">Copyright</a></li>
<li><a href="ubco-biology-open-materials.html#ubco-biology-open-materials" id="toc-ubco-biology-open-materials">UBCO Biology open materials</a></li>
</ul></li>
<li><a href="#part-getting-started-with-r-rstudio-r-markdown" id="toc-part-getting-started-with-r-rstudio-r-markdown">(PART*) Getting started with R, RStudio &amp; R Markdown</a></li>
<li><a href="what-is-R.html#what_is_R" id="toc-what_is_R">What are R and RStudio?</a></li>
<li><a href="install-R-Rstudio.html#install_R_Rstudio" id="toc-install_R_Rstudio">Installing R and RStudio</a></li>
<li><a href="start-r.html#start_r" id="toc-start_r">Start using R &amp; RStudio</a>
<ul>
<li><a href="Rstudio-interface.html#Rstudio_interface" id="toc-Rstudio_interface">The RStudio Interface</a></li>
<li><a href="coding-basics.html#coding_basics" id="toc-coding_basics">Coding basics</a></li>
</ul></li>
<li><a href="packages.html#packages" id="toc-packages">R packages</a>
<ul>
<li><a href="package-install.html#package_install" id="toc-package_install">Package installation</a></li>
<li><a href="package-load.html#package_load" id="toc-package_load">Package loading</a></li>
</ul></li>
<li><a href="intro-markdown.html#intro_markdown" id="toc-intro_markdown">Intro to R Markdown</a>
<ul>
<li><a href="lit-programming.html#lit_programming" id="toc-lit_programming">Literate programming with R Markdown</a></li>
<li><a href="veryify-knit.html#veryify_knit" id="toc-veryify_knit">Making sure R Markdown knits to PDF</a></li>
</ul></li>
<li><a href="r-resources.html#r_resources" id="toc-r_resources">Extra resources</a>
<ul>
<li><a href="online-resources.html#online_resources" id="toc-online_resources">R Resources Online</a></li>
<li><a href="rmd-graphing.html#rmd_graphing" id="toc-rmd_graphing">Setting up R Markdown for graphing</a></li>
<li><a href="example-answer.html#example_answer" id="toc-example_answer">Example question / answer</a></li>
<li><a href="knit-assign.html#knit_assign" id="toc-knit_assign">Knitting your assignment to PDF</a></li>
<li><a href="submit-rmd.html#submit_rmd" id="toc-submit_rmd">Submit your assignment</a></li>
</ul></li>
<li><a href="data-import.html#data_import" id="toc-data_import">Preparing and importing Tidy Data</a>
<ul>
<li><a href="tidy-data.html#tidy_data" id="toc-tidy_data">Tidy data</a></li>
<li><a href="import-csv-url.html#import_csv_url" id="toc-import_csv_url">Import a CSV file from a website</a></li>
<li><a href="create-csv-local.html#create_csv_local" id="toc-create_csv_local">Create a CSV file</a></li>
<li><a href="import-csv-local.html#import_csv_local" id="toc-import_csv_local">Import a local CSV file</a></li>
<li><a href="data-overview.html#data_overview" id="toc-data_overview">Get an overview of a dataset</a></li>
<li><a href="tutorial-practice-activities.html#tutorial-practice-activities" id="toc-tutorial-practice-activities">Tutorial practice activities</a></li>
</ul></li>
<li><a href="#part-visualizing-and-describing-data" id="toc-part-visualizing-and-describing-data">(PART*) Visualizing and Describing Data</a></li>
<li><a href="vis-variable.html#vis_variable" id="toc-vis_variable">Visualizing a single variable</a>
<ul>
<li><a href="vis-packages-data.html#vis_packages_data" id="toc-vis_packages_data">Load packages and import data</a></li>
<li><a href="vis-data-overview.html#vis_data_overview" id="toc-vis_data_overview">Get an overview of the data</a></li>
<li><a href="vis-cat-freq-table.html#vis_cat_freq_table" id="toc-vis_cat_freq_table">Create a frequency table</a></li>
<li><a href="vis-cat-barchart.html#vis_cat_barchart" id="toc-vis_cat_barchart">Create a bar graph</a></li>
<li><a href="vis-histogram.html#vis_histogram" id="toc-vis_histogram">Create a histogram</a></li>
<li><a href="vis-describe-hist.html#vis_describe_hist" id="toc-vis_describe_hist">Describing a histogram</a></li>
</ul></li>
<li><a href="vis-describe.html#vis_describe" id="toc-vis_describe">Describing a single variable</a>
<ul>
<li><a href="desc-packages-data.html#desc_packages_data" id="toc-desc_packages_data">Load packages and import data</a></li>
<li><a href="desc-cat-Var.html#desc_cat_Var" id="toc-desc_cat_Var">Describing a categorical variable</a></li>
<li><a href="desc-numeric-var.html#desc_numeric_var" id="toc-desc_numeric_var">Describing a numerical variable</a>
<ul>
<li><a href="desc-numeric-var.html#median_IQR" id="toc-median_IQR">Calculating the median &amp; IQR</a></li>
<li><a href="desc-numeric-var.html#mean_sd" id="toc-mean_sd">Calculating the mean &amp; standard deviation</a></li>
</ul></li>
<li><a href="desc-numeric-var-cat.html#desc_numeric_var_cat" id="toc-desc_numeric_var_cat">Describing a numerical variable grouped by a categorical variable</a></li>
</ul></li>
<li><a href="vis-twovar.html#vis_twovar" id="toc-vis_twovar">Visualizing associations between two variables</a>
<ul>
<li><a href="vis2-packages-data.html#vis2_packages_data" id="toc-vis2_packages_data">Load packages and import data</a></li>
<li><a href="vis2-2cat.html#vis2_2cat" id="toc-vis2_2cat">Visualizing association between two categorical variables</a>
<ul>
<li><a href="vis2-2cat.html#vis2_cont_table" id="toc-vis2_cont_table">Constructing a contingency table</a></li>
<li><a href="vis2-2cat.html#grouped_bar_graphs" id="toc-grouped_bar_graphs">Constructing a grouped bar graph</a></li>
<li><a href="vis2-2cat.html#mosaic_plot" id="toc-mosaic_plot">Constructing a mosaic plot</a></li>
<li><a href="vis2-2cat.html#interpret_mosaic" id="toc-interpret_mosaic">Interpreting mosaic plots</a></li>
</ul></li>
<li><a href="two-numeric.html#two_numeric" id="toc-two_numeric">Visualizing association between two numeric variables</a>
<ul>
<li><a href="two-numeric.html#interpret_scatter" id="toc-interpret_scatter">Interpreting and describing a scatterplot</a></li>
</ul></li>
<li><a href="numeric-vs-cat.html#numeric_vs_cat" id="toc-numeric_vs_cat">Visualizing association between a numeric and a categorical variable</a>
<ul>
<li><a href="numeric-vs-cat.html#stripchart" id="toc-stripchart">Create a stripchart</a></li>
<li><a href="numeric-vs-cat.html#violinplot" id="toc-violinplot">Create a violin plot</a></li>
<li><a href="numeric-vs-cat.html#boxplots" id="toc-boxplots">Creating a boxplot</a></li>
<li><a href="numeric-vs-cat.html#bestplot" id="toc-bestplot">Combining violin and boxplots</a></li>
<li><a href="numeric-vs-cat.html#interp_violin" id="toc-interp_violin">Interpreting stripcharts and boxplots</a></li>
</ul></li>
</ul></li>
<li><a href="#part-inferential-statistics" id="toc-part-inferential-statistics">(PART*) Inferential Statistics</a></li>
<li><a href="estimation.html#estimation" id="toc-estimation">Sampling, Estimation, &amp; Uncertainty</a>
<ul>
<li><a href="estimation-packages-data.html#estimation_packages_data" id="toc-estimation_packages_data">Load packages and import data</a></li>
<li><a href="sampling-functions.html#sampling_functions" id="toc-sampling_functions">Functions for sampling</a>
<ul>
<li><a href="sampling-functions.html#setseed" id="toc-setseed">Setting the “seed” for random sampling</a></li>
</ul></li>
<li><a href="sampling-error.html#sampling_error" id="toc-sampling_error">Sampling error</a></li>
<li><a href="sampdistmean.html#sampdistmean" id="toc-sampdistmean">Sampling distribution of the mean</a>
<ul>
<li><a href="sampdistmean.html#hist_samdist" id="toc-hist_samdist">Visualize the sampling distribution</a></li>
</ul></li>
<li><a href="sem-page.html#sem_page" id="toc-sem_page">Standard error of the mean</a></li>
<li><a href="confint-rough.html#confint_rough" id="toc-confint_rough">Rule of thumb 95% confidence interval</a></li>
</ul></li>
<li><a href="hypothesis.html#hypothesis" id="toc-hypothesis">Hypothesis testing</a>
<ul>
<li><a href="hyp-packages-data.html#hyp_packages_data" id="toc-hyp_packages_data">Load packages and import data</a></li>
<li><a href="hyp-steps.html#hyp_steps" id="toc-hyp_steps">Steps to hypothesis testing</a></li>
<li><a href="hyp-example.html#hyp_example" id="toc-hyp_example">An hypothesis test example</a>
<ul>
<li><a href="hyp-example.html#follow_hyp_steps" id="toc-follow_hyp_steps">Following the steps to hypothesis testing</a></li>
<li><a href="hyp-example.html#sim_null" id="toc-sim_null">Simulating a “null distribution”</a></li>
<li><a href="hyp-example.html#calc_p" id="toc-calc_p">Calculating the <em>P</em>-value</a></li>
<li><a href="hyp-example.html#concluding_statement" id="toc-concluding_statement">Writing a concluding statement</a></li>
</ul></li>
</ul></li>
<li><a href="single-cat.html#single_cat" id="toc-single_cat">Analyzing a single categorical variable</a>
<ul>
<li><a href="singcat-packages-data.html#singcat_packages_data" id="toc-singcat_packages_data">Load packages and import data</a></li>
<li><a href="estproportions.html#estproportions" id="toc-estproportions">Estimating proportions</a>
<ul>
<li><a href="estproportions.html#sterr_prop" id="toc-sterr_prop">Standard error for a proportion</a></li>
<li><a href="estproportions.html#confint_prop" id="toc-confint_prop">Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="binomdist.html#binomdist" id="toc-binomdist">Binomial distribution</a></li>
<li><a href="binom-test.html#binom_test" id="toc-binom_test">Binomial test</a></li>
<li><a href="prophypconf.html#prophypconf" id="toc-prophypconf">Confidence interval approach to hypothesis testing</a></li>
<li><a href="GOF-test.html#GOF_test" id="toc-GOF_test">Goodness-of-fit tests</a></li>
</ul></li>
<li><a href="two-cat.html#two_cat" id="toc-two_cat">Analyzing associations between two categorical variables</a>
<ul>
<li><a href="twocat-packages-data.html#twocat_packages_data" id="toc-twocat_packages_data">Load packages and import data</a></li>
<li><a href="fishertest.html#fishertest" id="toc-fishertest">Fisher’s Exact Test</a>
<ul>
<li><a href="fishertest.html#fisher_hyp" id="toc-fisher_hyp">Hypothesis statement</a></li>
<li><a href="fishertest.html#show_cont_table" id="toc-show_cont_table">Display a contingency table</a></li>
<li><a href="fishertest.html#show_mosaic" id="toc-show_mosaic">Display a mosaic plot</a></li>
<li><a href="fishertest.html#do_fisher" id="toc-do_fisher">Conduct the Fisher’s Exact Test</a></li>
</ul></li>
<li><a href="odds.html#odds" id="toc-odds">Estimate the Odds of getting sick</a></li>
<li><a href="oddsratio.html#oddsratio" id="toc-oddsratio">Estimate the odds ratio</a></li>
<li><a href="chisquare.html#chisquare" id="toc-chisquare"><span class="math inline">\(\chi\)</span><sup>2</sup> Contingency Test</a>
<ul>
<li><a href="chisquare.html#chihyp" id="toc-chihyp">Hypothesis statement</a></li>
<li><a href="chisquare.html#showwormcont" id="toc-showwormcont">Display the contingency table</a></li>
<li><a href="chisquare.html#mosaicworm" id="toc-mosaicworm">Visualize a mosaic plot</a></li>
<li><a href="chisquare.html#checkchiassum" id="toc-checkchiassum">Check the assumptions</a></li>
<li><a href="chisquare.html#chiresults" id="toc-chiresults">Get the results of the test</a></li>
</ul></li>
</ul></li>
<li><a href="single-numeric.html#single_numeric" id="toc-single_numeric">Analyzing a single numerical variable</a>
<ul>
<li><a href="singlenum-packages-data.html#singlenum_packages_data" id="toc-singlenum_packages_data">Load packages and import data</a></li>
<li><a href="onesamp-t-test.html#onesamp_t_test" id="toc-onesamp_t_test">One-sample <em>t</em>-test</a>
<ul>
<li><a href="onesamp-t-test.html#onesamp_hyp" id="toc-onesamp_hyp">Hypothesis statement</a></li>
<li><a href="onesamp-t-test.html#onesamp_assumptions" id="toc-onesamp_assumptions">Assumptions of one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_graph" id="toc-onesamp_graph">A graph to accompany a one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_test" id="toc-onesamp_test">Conduct the one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_conclude" id="toc-onesamp_conclude">Concluding statement for the one-sample <em>t</em>-test</a></li>
</ul></li>
<li><a href="t-confidence.html#t_confidence" id="toc-t_confidence">Confidence intervals for <span class="math inline">\(\mu\)</span></a>
<ul>
<li><a href="t-confidence.html#conf_precision" id="toc-conf_precision">Confidence interval as a measure of precision for an estimate</a></li>
<li><a href="t-confidence.html#conf_hyp" id="toc-conf_hyp">Confidence interval approach to hypothesis testing</a></li>
</ul></li>
</ul></li>
<li><a href="compare-two-means.html#compare_two_means" id="toc-compare_two_means">Comparing means among two groups</a>
<ul>
<li><a href="twomean-packages-data.html#twomean_packages_data" id="toc-twomean_packages_data">Load packages and import data</a></li>
<li><a href="paired-t-test.html#paired-t-test" id="toc-paired-t-test">Paired <em>t</em>-test</a>
<ul>
<li><a href="paired-t-test.html#calc_diffs" id="toc-calc_diffs">Calculate differences</a></li>
<li><a href="paired-t-test.html#paired_Htest" id="toc-paired_Htest">Hypothesis statement</a></li>
<li><a href="paired-t-test.html#graph_paried" id="toc-graph_paried">A graph to accompany a paired <em>t</em>-test</a></li>
<li><a href="paired-t-test.html#assump_paried" id="toc-assump_paried">Assumptions of the paired <em>t</em>-test</a></li>
<li><a href="paired-t-test.html#conduct_paired" id="toc-conduct_paired">Conduct the test</a></li>
<li><a href="paired-t-test.html#concl_paired" id="toc-concl_paired">Concluding statement</a></li>
</ul></li>
<li><a href="twosamp-ttest.html#twosamp_ttest" id="toc-twosamp_ttest">Two sample <em>t</em>-test</a>
<ul>
<li><a href="twosamp-ttest.html#twosamp_hyp" id="toc-twosamp_hyp">Hypothesis statement</a></li>
<li><a href="twosamp-ttest.html#stats_2samp" id="toc-stats_2samp">A table of descriptive statistics</a></li>
<li><a href="twosamp-ttest.html#graph_2samp" id="toc-graph_2samp">A graph to accompany a 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#twosamp_assump" id="toc-twosamp_assump">Assumptions of the 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#conduct_2samptest" id="toc-conduct_2samptest">Conduct the 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#concl_2samp" id="toc-concl_2samp">Concluding statement</a></li>
</ul></li>
<li><a href="assumpbad-2samp.html#assumpbad_2samp" id="toc-assumpbad_2samp">When assumptions aren’t met</a></li>
</ul></li>
<li><a href="compare-three-more-means.html#compare_three_more_means" id="toc-compare_three_more_means">Comparing means among more than two groups</a>
<ul>
<li><a href="anova-packages-data.html#anova_packages_data" id="toc-anova_packages_data">Load packages and import data</a></li>
<li><a href="do-the-anova.html#do_the_anova" id="toc-do_the_anova">Analysis of variance</a>
<ul>
<li><a href="do-the-anova.html#anova_hyps" id="toc-anova_hyps">Hypothesis statements</a></li>
<li><a href="do-the-anova.html#stats_anova" id="toc-stats_anova">A table of descriptive statistics</a></li>
<li><a href="do-the-anova.html#anova_graph1" id="toc-anova_graph1">Visualize the data</a></li>
<li><a href="do-the-anova.html#assump_anova" id="toc-assump_anova">Assumptions of ANOVA</a></li>
<li><a href="do-the-anova.html#do_anova1" id="toc-do_anova1">Conduct the ANOVA test</a></li>
<li><a href="do-the-anova.html#createanovatable" id="toc-createanovatable">Generate nice ANOVA table</a></li>
<li><a href="do-the-anova.html#calculate-r2-for-the-anova" id="toc-calculate-r2-for-the-anova">Calculate <span class="math inline">\(R^2\)</span> for the ANOVA</a></li>
<li><a href="do-the-anova.html#tukey" id="toc-tukey">Tukey-Kramer post-hoc test</a></li>
<li><a href="do-the-anova.html#vis_tukey" id="toc-vis_tukey">Visualizing post-hoc test results</a></li>
<li><a href="do-the-anova.html#anova_conclusion" id="toc-anova_conclusion">Concluding statement</a></li>
</ul></li>
<li><a href="assumpbad-anova.html#assumpbad_anova" id="toc-assumpbad_anova">When assumptions aren’t met</a></li>
</ul></li>
<li><a href="two-num.html#two_num" id="toc-two_num">Analyzing associations between two numerical variables</a>
<ul>
<li><a href="twonum-packages-data.html#twonum_packages_data" id="toc-twonum_packages_data">Load packages and import data</a></li>
<li><a href="pearson.html#pearson" id="toc-pearson">Pearson correlation analysis</a>
<ul>
<li><a href="pearson.html#pearson_hyp" id="toc-pearson_hyp">Hypothesis statements</a></li>
<li><a href="pearson.html#see_corr" id="toc-see_corr">Visualize the data</a></li>
<li><a href="pearson.html#corr_assumptions" id="toc-corr_assumptions">Assumptions of correlation analysis</a></li>
<li><a href="pearson.html#do_corr" id="toc-do_corr">Conduct the correlation analysis</a></li>
<li><a href="pearson.html#concl_corr" id="toc-concl_corr">Concluding statement</a></li>
</ul></li>
<li><a href="rankcorr.html#rankcorr" id="toc-rankcorr">Rank correlation (Spearman’s correlation)</a>
<ul>
<li><a href="rankcorr.html#hypothesis-statements" id="toc-hypothesis-statements">Hypothesis statements</a></li>
<li><a href="rankcorr.html#spearman_hyp" id="toc-spearman_hyp">Visualize the data</a></li>
<li><a href="rankcorr.html#assum_spear" id="toc-assum_spear">Assumptions of Spearman rank correlation</a></li>
<li><a href="rankcorr.html#conduct_spearman" id="toc-conduct_spearman">Conduct the test</a></li>
<li><a href="rankcorr.html#spear_conclude" id="toc-spear_conclude">Concluding statement</a></li>
</ul></li>
</ul></li>
<li><a href="creating-tables-in-r-markdown.html#creating-tables-in-r-markdown" id="toc-creating-tables-in-r-markdown">Creating tables in R Markdown</a>
<ul>
<li><a href="tables-packages.html#tables_packages" id="toc-tables_packages">Load packages and import data</a>
<ul>
<li><a href="tables-packages.html#skim_tables" id="toc-skim_tables">Formatting output from the <code>skimr</code> package</a></li>
<li><a href="tables-packages.html#stats_nicetable" id="toc-stats_nicetable">A nicely formatted table of descriptive statistics</a></li>
</ul></li>
</ul></li>
<li><a href="checking-assumptions-and-data-transformations.html#checking-assumptions-and-data-transformations" id="toc-checking-assumptions-and-data-transformations">Checking assumptions and data transformations</a>
<ul>
<li><a href="assumptions-packages-data.html#assumptions_packages_data" id="toc-assumptions_packages_data">Load packages and import data</a></li>
<li><a href="checknorm-assum.html#checknorm_assum" id="toc-checknorm_assum">Checking the normality assumption</a>
<ul>
<li><a href="checknorm-assum.html#quantile_plots" id="toc-quantile_plots">Normal quantile plots</a></li>
<li><a href="checknorm-assum.html#shapirottest" id="toc-shapirottest">Shapiro-Wilk test for normality</a></li>
</ul></li>
<li><a href="levenetest.html#levenetest" id="toc-levenetest">Checking the equal-variance assumption</a></li>
<li><a href="transform.html#transform" id="toc-transform">Data transformations</a>
<ul>
<li><a href="transform.html#log_transform" id="toc-log_transform">Log-transform</a></li>
<li><a href="transform.html#zeroes" id="toc-zeroes">Dealing with zeroes</a></li>
<li><a href="transform.html#logbases" id="toc-logbases">Log bases</a></li>
<li><a href="transform.html#back_transform" id="toc-back_transform">Back-transforming log data</a></li>
<li><a href="transform.html#logit_transform" id="toc-logit_transform">Logit transform</a></li>
<li><a href="transform.html#logit_back" id="toc-logit_back">Back-transforming logit data</a></li>
<li><a href="transform.html#when_back" id="toc-when_back">When to back-transform?</a></li>
</ul></li>
</ul></li>
<li><a href="visual-markdown-editor.html#visual-markdown-editor" id="toc-visual-markdown-editor">Visual Markdown Editor</a>
<ul>
<li><a href="a-more-familiar-editing-environment.html#a-more-familiar-editing-environment" id="toc-a-more-familiar-editing-environment">A more familiar editing environment</a></li>
</ul></li>
<li><a href="common-errors-and-their-solutions.html#common-errors-and-their-solutions" id="toc-common-errors-and-their-solutions">Common errors and their solutions</a>
<ul>
<li><a href="google-can-help.html#google-can-help" id="toc-google-can-help">Google can help</a></li>
<li><a href="rtools-required-during-install.html#rtools-required-during-install" id="toc-rtools-required-during-install">Rtools required during install</a></li>
<li><a href="could-not-find-function.html#could-not-find-function" id="toc-could-not-find-function">Could not find function</a></li>
<li><a href="there-is-no-package.html#there-is-no-package" id="toc-there-is-no-package">There is no package</a></li>
<li><a href="trying-to-use-cran-without-setting-a-mirror.html#trying-to-use-cran-without-setting-a-mirror" id="toc-trying-to-use-cran-without-setting-a-mirror">Trying to use CRAN without setting a mirror</a></li>
<li><a href="pdf-latex-is-not-found.html#pdf-latex-is-not-found" id="toc-pdf-latex-is-not-found">PDF Latex is not found</a></li>
<li><a href="error-in-parse.html#error-in-parse" id="toc-error-in-parse">Error in parse</a></li>
<li><a href="no-such-file-or-directory-exists.html#no-such-file-or-directory-exists" id="toc-no-such-file-or-directory-exists">No such file or directory exists</a></li>
<li><a href="messy-output-when-loading-packages.html#messy-output-when-loading-packages" id="toc-messy-output-when-loading-packages">Messy output when loading packages</a></li>
<li><a href="unused-argument.html#unused-argument" id="toc-unused-argument">Unused argument</a></li>
<li><a href="object-not-found.html#object-not-found" id="toc-object-not-found">Object not found</a></li>
<li><a href="figure-caption-doesnt-show-up-below-figure-in-knitted-document.html#figure-caption-doesnt-show-up-below-figure-in-knitted-document" id="toc-figure-caption-doesnt-show-up-below-figure-in-knitted-document">Figure caption doesn’t show up below figure in knitted document</a></li>
<li><a href="filename-directory-name-or-volume-label-syntax-is-incorrect.html#filename-directory-name-or-volume-label-syntax-is-incorrect" id="toc-filename-directory-name-or-volume-label-syntax-is-incorrect">Filename, directory name, or volume label syntax is incorrect</a></li>
<li><a href="installing-packages-there-is-a-binary-version-available.html#installing-packages-there-is-a-binary-version-available" id="toc-installing-packages-there-is-a-binary-version-available">Installing packages: there is a binary version available</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorials for BIOL202: Introduction to Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="numeric_vs_cat" class="section level2">
<h2>Visualizing association between a numeric and a categorical variable</h2>
<p>To visualize association between a numerical response variable and a categorical explanatory variable, we have a variety of options, and the choice depends in part on the sample sizes within the categories being visualized.</p>
<ul>
<li>When sample sizes are relatively small in each category, such as 20 or fewer, use a <strong>stripchart</strong></li>
<li>When sample sizes are larger (&gt;20), use a <strong>violin plot</strong>, or less ideal, a <strong>boxplot</strong>.</li>
</ul>
<p>We’ll use locust serotonin data set from the text book. Consult figure 2.1-2 in the text for a description.</p>
<div class="note">
<p><strong>Tip</strong>
Always remember to get an overview of the dataset before attempting to create graphs, and not only for establishing sample sizes. If you had gotten an overview of the <code>locust</code> dataset, you would see we have a numeric response variable “serotoninLevel”, but the categorical (explanatory) variable “treatmentTime” is actually coded as a numerical variable, with values of 0, 1, or 2 hours. Although this variable is coded as numeric, we can treat it as though it is an <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Ordinal-categorical-data">ordinal categorical variable</a>.</p>
</div>
<p>We should re-code the “treatmentTime” variable in the <code>locust</code> dataset as a “factor” variable with three “levels”: 0, 1, 2. This is not necessary for our graphs to work, but it is good practice to do this when you encounter this situation where a variable that should be treated as an ordinal categorical variable is coded as numerical.</p>
<p>We do this using the <code>as.factor</code> function, as follows:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="numeric-vs-cat.html#cb89-1" aria-hidden="true" tabindex="-1"></a>locust<span class="sc">$</span>treatmentTime <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(locust<span class="sc">$</span>treatmentTime)</span></code></pre></div>
<p>Before creating a stripchart, it’s a good idea to prepare a table of descriptive stats for your numerical response variable grouped by the categorical variable.</p>
<hr />
<ol style="list-style-type: decimal">
<li>Using what you learned in a <a href="desc-numeric-var-cat.html#desc_numeric_var_cat">previous tutorial</a>, create a table of descriptive statistics of serotonin levels grouped by the treatment group variable.</li>
</ol>
<hr />
<div id="stripchart" class="section level3">
<h3>Create a stripchart</h3>
<p>Now we’re ready to create a stripchart of the locust experiment data. Note that we’re not yet ready to add “error bars” to our strip chart; that will come in a later tutorial.</p>
<p>We’ll provide the code, then explain after:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="numeric-vs-cat.html#cb90-1" aria-hidden="true" tabindex="-1"></a>locust <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="numeric-vs-cat.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treatmentTime, <span class="at">y =</span> serotoninLevel)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="numeric-vs-cat.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="numeric-vs-cat.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Treatment time (hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-5"><a href="numeric-vs-cat.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Serotonin (pmoles)&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-6"><a href="numeric-vs-cat.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb90-7"><a href="numeric-vs-cat.html#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-41"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-41-1.png" alt="Serotonin levels in the central nervous system of desert locusts that were experimentally crowded for 0 (control), 1, and 2 hours. N = 10 per treatment group." width="384" />
<p class="caption">
Figure 16: Serotonin levels in the central nervous system of desert locusts that were experimentally crowded for 0 (control), 1, and 2 hours. N = 10 per treatment group.
</p>
</div>
<ul>
<li>the <code>ggplot</code> line of code is familiar</li>
<li>the new function here is the <code>geom_jitter</code> function that simply plots the points in each group such that they are “jittered” or offset from one-another (to make them more visible). Its arguments include ‘colour = “black”’ telling R to use black points, “size = 3” to make the points a little larger than the default (1), “shape = 1” denoting hollow circles, and “width = 0.1” telling R to jitter the points a relatively small amount in the horizontal direction. Feel free to play with this arguments to get a feel for how they work.</li>
<li>the x- and y-axis labels come next</li>
<li>then we specify the minimum and maximum limits to the y-axis using the <code>ylim</code> function</li>
</ul>
<p>Notice how all the data are visible! And it’s evident that in the control and 1-hour treatment groups the majority of locusts exhibited comparatively low levels of serotonin (note the clusters of points).</p>
</div>
<div id="violinplot" class="section level3">
<h3>Create a violin plot</h3>
<p>Given that violin plots are best suited to when one has larger sample sizes per group, we’ll go back to the <code>penguins</code> dataset for this, and evaluate how body mass of male penguins varies among species.</p>
<p>Let’s first find out more about the data for the male penguins, so that we can include sample sizes in our figure captions. Specifically, we’ll tally the number of complete body mass observations for each species, and also the number of missing values (NAs).</p>
<p>We’ll combine the <code>filter</code> function with the <code>group_by</code> function that we learned about in a <a href="desc-numeric-var-cat.html#desc_numeric_var_cat">previous tutorial</a>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="numeric-vs-cat.html#cb91-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="numeric-vs-cat.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="numeric-vs-cat.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="numeric-vs-cat.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb91-5"><a href="numeric-vs-cat.html#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>() <span class="sc">-</span> naniar<span class="sc">::</span><span class="fu">n_miss</span>(body_mass_g),</span>
<span id="cb91-6"><a href="numeric-vs-cat.html#cb91-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count_NA =</span> naniar<span class="sc">::</span><span class="fu">n_miss</span>(body_mass_g))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   species   Count Count_NA
##   &lt;fct&gt;     &lt;int&gt;    &lt;int&gt;
## 1 Adelie       73        0
## 2 Chinstrap    34        0
## 3 Gentoo       61        0</code></pre>
<p>This is the same code we used <a href="desc-numeric-var-cat.html#desc_numeric_var_cat">previously</a> for calculating descriptive statistics using a grouping variable (though we’ve eliminated some of the descriptive statistics here), but we inserted the <code>filter</code> function in the second line to make sure we’re only using the male penguin records.</p>
<p>We now have the accurate sample sizes for each species (under the “Count” variable) we need to report in any figure caption.</p>
<p>We use the familiar <code>ggplot</code> approach for creating violin plots.</p>
<div class="note">
<p><strong>Tip</strong>
When using the <code>ggplot</code> function, we can assign the output to an object. We can then subsequently add features to the plot by adding to the object. We’ll demonstrate this here.</p>
</div>
<p>Let’s assign the basic violin plot to an object called “bodymass.violin”, and we’ll explain the rest of the code after:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="numeric-vs-cat.html#cb93-1" aria-hidden="true" tabindex="-1"></a>bodymass.violin <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="numeric-vs-cat.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="numeric-vs-cat.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb93-4"><a href="numeric-vs-cat.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb93-5"><a href="numeric-vs-cat.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb93-6"><a href="numeric-vs-cat.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Body mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb93-7"><a href="numeric-vs-cat.html#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<ul>
<li>We assign the output to the object called “bodymass.violin”, and tell R which data object we’re using (penguins)</li>
<li>We then <code>filter</code> the dataset to include only male penguins (sex == “male”), and note the two equal signs and the quotations around “male”</li>
<li>Then the familar <code>ggplot</code> with its <code>aes</code> argument</li>
<li>Now the new <code>geom_violin</code> function, and it has optional arguments that we haven’t used (see help file for the function)</li>
<li>Then the familiar labels and theme functions</li>
</ul>
<p>Let’s now have a look at the graph, and to do so, we simply type the name of the graph object we created:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="numeric-vs-cat.html#cb94-1" aria-hidden="true" tabindex="-1"></a>bodymass.violin</span></code></pre></div>
<p><img src="BIOL202_files/figure-html/body_violin-1.png" width="384" /></p>
<p>One problem with the above graph is that we don’t see the individual data points.</p>
<p>We can add those using the <code>geom_jitter</code> function we learned about when <a href="numeric-vs-cat.html#stripchart">creating stripcharts</a>.</p>
<p>Here’s how we add features to an existing <code>ggplot</code> graph object, and we can again create a new object, or simply replace the old one.</p>
<p>Here, we’ll create a new object called “bodymass.violin.points”:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="numeric-vs-cat.html#cb95-1" aria-hidden="true" tabindex="-1"></a>bodymass.violin.points <span class="ot">&lt;-</span> bodymass.violin <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p>And now show the plot:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="numeric-vs-cat.html#cb96-1" aria-hidden="true" tabindex="-1"></a>bodymass.violin.points</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-42"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-42-1.png" alt="Violin plot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins." width="384" />
<p class="caption">
Figure 17: Violin plot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins.
</p>
</div>
<p>To help understand what the violin plot is showing, we’ll provide a new <strong>bonus</strong> graph that adds something called “density plots” to the margin of the violin plot.</p>
<p>Don’t worry about replicating this type of graph, but if you can, fantastic!</p>
<p>First we create the main <code>ggplot</code> violin plot object:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="numeric-vs-cat.html#cb97-1" aria-hidden="true" tabindex="-1"></a>bodymass.violin2 <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="numeric-vs-cat.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="numeric-vs-cat.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb97-4"><a href="numeric-vs-cat.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass_g, <span class="at">colour =</span> species)) <span class="sc">+</span></span>
<span id="cb97-5"><a href="numeric-vs-cat.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass_g, <span class="at">colour =</span> species), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb97-6"><a href="numeric-vs-cat.html#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb97-7"><a href="numeric-vs-cat.html#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Body mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb97-8"><a href="numeric-vs-cat.html#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">3000</span>, <span class="dv">6300</span>) <span class="sc">+</span></span>
<span id="cb97-9"><a href="numeric-vs-cat.html#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb97-10"><a href="numeric-vs-cat.html#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb97-11"><a href="numeric-vs-cat.html#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Species&quot;</span>))</span></code></pre></div>
<p>Now we add density plots in the margins using the <code>ggMarginal</code> function from the <code>ggExtra</code> package:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="numeric-vs-cat.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(bodymass.violin2, <span class="at">type =</span> <span class="st">&quot;density&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">groupFill =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-43"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-43-1.png" alt="Violin plot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins. Density plots are provided in the margin." width="480" />
<p class="caption">
Figure 18: Violin plot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins. Density plots are provided in the margin.
</p>
</div>
<p>The violin plot is designed to give an idea of the frequency distribution of response variable values within each group. Specifically, the width of the violin reflects the frequency of observations in that range of values. This is evident in the above figure within the “density plots” that are provided in the right-hand margin. Consider these density plots as a smoothed out version of a histogram.</p>
<p>We can see, for example, that for all three species of penguin there is a bulge in the middle indicating that there is a central <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Mode">mode</a> to the body mass values in each group, with fewer values towards lower and higher extremes. The frequency distribution for the Gentoo species approximates a “bell shape” distribution, for example (the blue data).</p>
</div>
<div id="boxplots" class="section level3">
<h3>Creating a boxplot</h3>
<p>Here we’ll learn how to create basic boxplots, and also superimpose boxplots onto violin plots.</p>
<p>In future tutorials we’ll learn how to add features to these types of graphs in order to complement statistical comparisons of a numerical response variable among categories (groups) of a categorical explanatory variable.</p>
<p>Here is the code for creating boxplots, again using the penguins body mass data, and this time the <code>geom_boxplot</code> function:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="numeric-vs-cat.html#cb99-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="numeric-vs-cat.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="numeric-vs-cat.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb99-4"><a href="numeric-vs-cat.html#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb99-5"><a href="numeric-vs-cat.html#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Species&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-6"><a href="numeric-vs-cat.html#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Body mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-7"><a href="numeric-vs-cat.html#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-44"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-44-1.png" alt="Boxplot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins. Density plots are provided in the margin. Boxes delimit the first and third quartiles, and the middle line depicts the median. Whiskers extend to values beyond the 1st (lower) and 3rd (upper) quartiles, up to a maximum of 1.5 x IQR, and individual black points are outlying values." width="384" />
<p class="caption">
Figure 19: Boxplot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins. Density plots are provided in the margin. Boxes delimit the first and third quartiles, and the middle line depicts the median. Whiskers extend to values beyond the 1st (lower) and 3rd (upper) quartiles, up to a maximum of 1.5 x IQR, and individual black points are outlying values.
</p>
</div>
<p>For more information about the features of the boxplot, look at the help file for the <code>geom_boxplot</code> function:</p>
<pre><code>?geom_boxplot</code></pre>
<div class="note">
<p><strong>NOTE</strong>
The first time you include a boxplot in a report / lab, be sure to include in the figure caption the details of what is being shown. You only need to do this the first time. Subsequent boxplot figure captions can refer to the first one for details.</p>
</div>
<p>When sample sizes are large in each group, like they are for the penguins data we’ve been visualizing, the most ideal way to visualize the data is to combine violin and boxplots. We’ll do this next!</p>
</div>
<div id="bestplot" class="section level3">
<h3>Combining violin and boxplots</h3>
<p>Superimposing boxplots onto violin plots (and of course, showing individual points too!) provides for a very informative graph.</p>
<p>We already have a basic violin plot object created, called “bodymass.violin”, so let’s start with that, then add the boxplot information, then superimpose the points. We need to do it in that order, so that the points become the “top” layer of information, and aren’t hidden behind the boxplot or violins.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="numeric-vs-cat.html#cb101-1" aria-hidden="true" tabindex="-1"></a>bodymass.violin <span class="sc">+</span> </span>
<span id="cb101-2"><a href="numeric-vs-cat.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb101-3"><a href="numeric-vs-cat.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-45"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-45-1.png" alt="Violin plot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins. Boxplots are superimposed, with boxes delimiting the first and third quartiles, and middle line depicting the median. Whiskers extend to values beyond the 1st (lower) and 3rd (upper) quartiles, up to a maximum of 1.5 x IQR, and individual black points are outlying values." width="384" />
<p class="caption">
Figure 20: Violin plot showing the body mass (g) of male Adelie (N = 73), Chinstrap (N = 34), and Gentoo (N = 61) penguins. Boxplots are superimposed, with boxes delimiting the first and third quartiles, and middle line depicting the median. Whiskers extend to values beyond the 1st (lower) and 3rd (upper) quartiles, up to a maximum of 1.5 x IQR, and individual black points are outlying values.
</p>
</div>
<ul>
<li>We start with the base violin plot object “bodymass.violin”</li>
<li>We then add the boxplot using <code>geom_boxplot</code>, ensuring that the boxes are narrow in width (width = 0.1) so they don’t overwhelm the violins</li>
<li>We then add the individual data points using <code>geom_jitter</code>, and this time using the colour “grey” so that they don’t obscure the black boxes underneath, and making them a bit smaller this time (size = 1), and keeping them as hollow circles (shape = 1), and this time spreading them out horizontally a bit more (width = 0.15)</li>
</ul>
<div class="note">
<p><strong>Tip</strong>
It often takes some playing around with argument values before one gets the ideal graph. For example, in the above graph, try changing some of the values used in the <code>geom_jitter</code> function.</p>
</div>
<ol style="list-style-type: decimal">
<li>Using the <code>penguins</code> dataset, and only the records pertaining to female penguins, create a combined violin / boxplot graph showing bill length in relation to species. Include an appropriate figure caption.</li>
</ol>
</div>
<div id="interp_violin" class="section level3">
<h3>Interpreting stripcharts and boxplots</h3>
<p>We will wait until a future tutorial to learn more about interpreting violin / boxplots, because there we learn how to add more information to the graphs, such as group <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Mean">means</a> and measures of uncertainty.</p>

</div>
</div>
<!-- </div> -->



            </section>

          </div>
        </div>
      </div>
<a href="two-numeric.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estimation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highight": true,
"download": ["pdf", "epub"]
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
