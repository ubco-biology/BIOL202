<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Visualizing association between two categorical variables | Tutorials for BIOL202: Introduction to Biostatistics</title>
  <meta name="description" content="All tutorials associated with BIOL202" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Visualizing association between two categorical variables | Tutorials for BIOL202: Introduction to Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="All tutorials associated with BIOL202" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Visualizing association between two categorical variables | Tutorials for BIOL202: Introduction to Biostatistics" />
  
  <meta name="twitter:description" content="All tutorials associated with BIOL202" />
  

<meta name="author" content="Jason Pither" />


<meta name="date" content="2022-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vis2-packages-data.html"/>
<link rel="next" href="two-numeric.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DVMYRT2ND2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DVMYRT2ND2');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOL202 Tutorials</a></li>

<li class="divider"></li>
<li><a href="#part-preface" id="toc-part-preface">(PART*) Preface</a></li>
<li><a href="index.html#welcome" id="toc-welcome">Welcome</a>
<ul>
<li><a href="author.html#author" id="toc-author">Author</a></li>
<li><a href="acknowledgments.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
<li><a href="copyright.html#copyright" id="toc-copyright">Copyright</a></li>
<li><a href="ubco-biology-open-materials.html#ubco-biology-open-materials" id="toc-ubco-biology-open-materials">UBCO Biology open materials</a></li>
</ul></li>
<li><a href="#part-getting-started-with-r-rstudio-r-markdown" id="toc-part-getting-started-with-r-rstudio-r-markdown">(PART*) Getting started with R, RStudio &amp; R Markdown</a></li>
<li><a href="what-is-R.html#what_is_R" id="toc-what_is_R">What are R and RStudio?</a></li>
<li><a href="install-R-Rstudio.html#install_R_Rstudio" id="toc-install_R_Rstudio">Installing R and RStudio</a></li>
<li><a href="start-r.html#start_r" id="toc-start_r">Start using R &amp; RStudio</a>
<ul>
<li><a href="Rstudio-interface.html#Rstudio_interface" id="toc-Rstudio_interface">The RStudio Interface</a></li>
<li><a href="coding-basics.html#coding_basics" id="toc-coding_basics">Coding basics</a></li>
</ul></li>
<li><a href="packages.html#packages" id="toc-packages">R packages</a>
<ul>
<li><a href="package-install.html#package_install" id="toc-package_install">Package installation</a></li>
<li><a href="package-load.html#package_load" id="toc-package_load">Package loading</a></li>
</ul></li>
<li><a href="intro-markdown.html#intro_markdown" id="toc-intro_markdown">Intro to R Markdown</a>
<ul>
<li><a href="lit-programming.html#lit_programming" id="toc-lit_programming">Literate programming with R Markdown</a></li>
<li><a href="veryify-knit.html#veryify_knit" id="toc-veryify_knit">Making sure R Markdown knits to PDF</a></li>
</ul></li>
<li><a href="r-resources.html#r_resources" id="toc-r_resources">Extra resources</a>
<ul>
<li><a href="online-resources.html#online_resources" id="toc-online_resources">R Resources Online</a></li>
<li><a href="rmd-graphing.html#rmd_graphing" id="toc-rmd_graphing">Setting up R Markdown for graphing</a></li>
<li><a href="example-answer.html#example_answer" id="toc-example_answer">Example question / answer</a></li>
<li><a href="knit-assign.html#knit_assign" id="toc-knit_assign">Knitting your assignment to PDF</a></li>
<li><a href="submit-rmd.html#submit_rmd" id="toc-submit_rmd">Submit your assignment</a></li>
</ul></li>
<li><a href="data-import.html#data_import" id="toc-data_import">Preparing and importing Tidy Data</a>
<ul>
<li><a href="tidy-data.html#tidy_data" id="toc-tidy_data">Tidy data</a></li>
<li><a href="import-csv-url.html#import_csv_url" id="toc-import_csv_url">Import a CSV file from a website</a></li>
<li><a href="create-csv-local.html#create_csv_local" id="toc-create_csv_local">Create a CSV file</a></li>
<li><a href="import-csv-local.html#import_csv_local" id="toc-import_csv_local">Import a local CSV file</a></li>
<li><a href="data-overview.html#data_overview" id="toc-data_overview">Get an overview of a dataset</a></li>
<li><a href="tutorial-practice-activities.html#tutorial-practice-activities" id="toc-tutorial-practice-activities">Tutorial practice activities</a></li>
</ul></li>
<li><a href="#part-visualizing-and-describing-data" id="toc-part-visualizing-and-describing-data">(PART*) Visualizing and Describing Data</a></li>
<li><a href="vis-variable.html#vis_variable" id="toc-vis_variable">Visualizing a single variable</a>
<ul>
<li><a href="vis-packages-data.html#vis_packages_data" id="toc-vis_packages_data">Load packages and import data</a></li>
<li><a href="vis-data-overview.html#vis_data_overview" id="toc-vis_data_overview">Get an overview of the data</a></li>
<li><a href="vis-cat-freq-table.html#vis_cat_freq_table" id="toc-vis_cat_freq_table">Create a frequency table</a></li>
<li><a href="vis-cat-barchart.html#vis_cat_barchart" id="toc-vis_cat_barchart">Create a bar graph</a></li>
<li><a href="vis-histogram.html#vis_histogram" id="toc-vis_histogram">Create a histogram</a></li>
<li><a href="vis-describe-hist.html#vis_describe_hist" id="toc-vis_describe_hist">Describing a histogram</a></li>
</ul></li>
<li><a href="vis-describe.html#vis_describe" id="toc-vis_describe">Describing a single variable</a>
<ul>
<li><a href="desc-packages-data.html#desc_packages_data" id="toc-desc_packages_data">Load packages and import data</a></li>
<li><a href="desc-cat-Var.html#desc_cat_Var" id="toc-desc_cat_Var">Describing a categorical variable</a></li>
<li><a href="desc-numeric-var.html#desc_numeric_var" id="toc-desc_numeric_var">Describing a numerical variable</a>
<ul>
<li><a href="desc-numeric-var.html#median_IQR" id="toc-median_IQR">Calculating the median &amp; IQR</a></li>
<li><a href="desc-numeric-var.html#mean_sd" id="toc-mean_sd">Calculating the mean &amp; standard deviation</a></li>
</ul></li>
<li><a href="desc-numeric-var-cat.html#desc_numeric_var_cat" id="toc-desc_numeric_var_cat">Describing a numerical variable grouped by a categorical variable</a></li>
</ul></li>
<li><a href="vis-twovar.html#vis_twovar" id="toc-vis_twovar">Visualizing associations between two variables</a>
<ul>
<li><a href="vis2-packages-data.html#vis2_packages_data" id="toc-vis2_packages_data">Load packages and import data</a></li>
<li><a href="vis2-2cat.html#vis2_2cat" id="toc-vis2_2cat">Visualizing association between two categorical variables</a>
<ul>
<li><a href="vis2-2cat.html#vis2_cont_table" id="toc-vis2_cont_table">Constructing a contingency table</a></li>
<li><a href="vis2-2cat.html#grouped_bar_graphs" id="toc-grouped_bar_graphs">Constructing a grouped bar graph</a></li>
<li><a href="vis2-2cat.html#mosaic_plot" id="toc-mosaic_plot">Constructing a mosaic plot</a></li>
<li><a href="vis2-2cat.html#interpret_mosaic" id="toc-interpret_mosaic">Interpreting mosaic plots</a></li>
</ul></li>
<li><a href="two-numeric.html#two_numeric" id="toc-two_numeric">Visualizing association between two numeric variables</a>
<ul>
<li><a href="two-numeric.html#interpret_scatter" id="toc-interpret_scatter">Interpreting and describing a scatterplot</a></li>
</ul></li>
<li><a href="numeric-vs-cat.html#numeric_vs_cat" id="toc-numeric_vs_cat">Visualizing association between a numeric and a categorical variable</a>
<ul>
<li><a href="numeric-vs-cat.html#stripchart" id="toc-stripchart">Create a stripchart</a></li>
<li><a href="numeric-vs-cat.html#violinplot" id="toc-violinplot">Create a violin plot</a></li>
<li><a href="numeric-vs-cat.html#boxplots" id="toc-boxplots">Creating a boxplot</a></li>
<li><a href="numeric-vs-cat.html#bestplot" id="toc-bestplot">Combining violin and boxplots</a></li>
<li><a href="numeric-vs-cat.html#interp_violin" id="toc-interp_violin">Interpreting stripcharts and boxplots</a></li>
</ul></li>
</ul></li>
<li><a href="#part-inferential-statistics" id="toc-part-inferential-statistics">(PART*) Inferential Statistics</a></li>
<li><a href="estimation.html#estimation" id="toc-estimation">Sampling, Estimation, &amp; Uncertainty</a>
<ul>
<li><a href="estimation-packages-data.html#estimation_packages_data" id="toc-estimation_packages_data">Load packages and import data</a></li>
<li><a href="sampling-functions.html#sampling_functions" id="toc-sampling_functions">Functions for sampling</a>
<ul>
<li><a href="sampling-functions.html#setseed" id="toc-setseed">Setting the “seed” for random sampling</a></li>
</ul></li>
<li><a href="sampling-error.html#sampling_error" id="toc-sampling_error">Sampling error</a></li>
<li><a href="sampdistmean.html#sampdistmean" id="toc-sampdistmean">Sampling distribution of the mean</a>
<ul>
<li><a href="sampdistmean.html#hist_samdist" id="toc-hist_samdist">Visualize the sampling distribution</a></li>
</ul></li>
<li><a href="sem-page.html#sem_page" id="toc-sem_page">Standard error of the mean</a></li>
<li><a href="confint-rough.html#confint_rough" id="toc-confint_rough">Rule of thumb 95% confidence interval</a></li>
</ul></li>
<li><a href="hypothesis.html#hypothesis" id="toc-hypothesis">Hypothesis testing</a>
<ul>
<li><a href="hyp-packages-data.html#hyp_packages_data" id="toc-hyp_packages_data">Load packages and import data</a></li>
<li><a href="hyp-steps.html#hyp_steps" id="toc-hyp_steps">Steps to hypothesis testing</a></li>
<li><a href="hyp-example.html#hyp_example" id="toc-hyp_example">An hypothesis test example</a>
<ul>
<li><a href="hyp-example.html#follow_hyp_steps" id="toc-follow_hyp_steps">Following the steps to hypothesis testing</a></li>
<li><a href="hyp-example.html#sim_null" id="toc-sim_null">Simulating a “null distribution”</a></li>
<li><a href="hyp-example.html#calc_p" id="toc-calc_p">Calculating the <em>P</em>-value</a></li>
<li><a href="hyp-example.html#concluding_statement" id="toc-concluding_statement">Writing a concluding statement</a></li>
</ul></li>
</ul></li>
<li><a href="single-cat.html#single_cat" id="toc-single_cat">Analyzing a single categorical variable</a>
<ul>
<li><a href="singcat-packages-data.html#singcat_packages_data" id="toc-singcat_packages_data">Load packages and import data</a></li>
<li><a href="estproportions.html#estproportions" id="toc-estproportions">Estimating proportions</a>
<ul>
<li><a href="estproportions.html#sterr_prop" id="toc-sterr_prop">Standard error for a proportion</a></li>
<li><a href="estproportions.html#confint_prop" id="toc-confint_prop">Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="binomdist.html#binomdist" id="toc-binomdist">Binomial distribution</a></li>
<li><a href="binom-test.html#binom_test" id="toc-binom_test">Binomial test</a></li>
<li><a href="prophypconf.html#prophypconf" id="toc-prophypconf">Confidence interval approach to hypothesis testing</a></li>
<li><a href="GOF-test.html#GOF_test" id="toc-GOF_test">Goodness-of-fit tests</a></li>
</ul></li>
<li><a href="two-cat.html#two_cat" id="toc-two_cat">Analyzing associations between two categorical variables</a>
<ul>
<li><a href="twocat-packages-data.html#twocat_packages_data" id="toc-twocat_packages_data">Load packages and import data</a></li>
<li><a href="fishertest.html#fishertest" id="toc-fishertest">Fisher’s Exact Test</a>
<ul>
<li><a href="fishertest.html#fisher_hyp" id="toc-fisher_hyp">Hypothesis statement</a></li>
<li><a href="fishertest.html#show_cont_table" id="toc-show_cont_table">Display a contingency table</a></li>
<li><a href="fishertest.html#show_mosaic" id="toc-show_mosaic">Display a mosaic plot</a></li>
<li><a href="fishertest.html#do_fisher" id="toc-do_fisher">Conduct the Fisher’s Exact Test</a></li>
</ul></li>
<li><a href="odds.html#odds" id="toc-odds">Estimate the Odds of getting sick</a></li>
<li><a href="oddsratio.html#oddsratio" id="toc-oddsratio">Estimate the odds ratio</a></li>
<li><a href="chisquare.html#chisquare" id="toc-chisquare"><span class="math inline">\(\chi\)</span><sup>2</sup> Contingency Test</a>
<ul>
<li><a href="chisquare.html#chihyp" id="toc-chihyp">Hypothesis statement</a></li>
<li><a href="chisquare.html#showwormcont" id="toc-showwormcont">Display the contingency table</a></li>
<li><a href="chisquare.html#mosaicworm" id="toc-mosaicworm">Visualize a mosaic plot</a></li>
<li><a href="chisquare.html#checkchiassum" id="toc-checkchiassum">Check the assumptions</a></li>
<li><a href="chisquare.html#chiresults" id="toc-chiresults">Get the results of the test</a></li>
</ul></li>
</ul></li>
<li><a href="single-numeric.html#single_numeric" id="toc-single_numeric">Analyzing a single numerical variable</a>
<ul>
<li><a href="singlenum-packages-data.html#singlenum_packages_data" id="toc-singlenum_packages_data">Load packages and import data</a></li>
<li><a href="onesamp-t-test.html#onesamp_t_test" id="toc-onesamp_t_test">One-sample <em>t</em>-test</a>
<ul>
<li><a href="onesamp-t-test.html#onesamp_hyp" id="toc-onesamp_hyp">Hypothesis statement</a></li>
<li><a href="onesamp-t-test.html#onesamp_assumptions" id="toc-onesamp_assumptions">Assumptions of one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_graph" id="toc-onesamp_graph">A graph to accompany a one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_test" id="toc-onesamp_test">Conduct the one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_conclude" id="toc-onesamp_conclude">Concluding statement for the one-sample <em>t</em>-test</a></li>
</ul></li>
<li><a href="t-confidence.html#t_confidence" id="toc-t_confidence">Confidence intervals for <span class="math inline">\(\mu\)</span></a>
<ul>
<li><a href="t-confidence.html#conf_precision" id="toc-conf_precision">Confidence interval as a measure of precision for an estimate</a></li>
<li><a href="t-confidence.html#conf_hyp" id="toc-conf_hyp">Confidence interval approach to hypothesis testing</a></li>
</ul></li>
</ul></li>
<li><a href="compare-two-means.html#compare_two_means" id="toc-compare_two_means">Comparing means among two groups</a>
<ul>
<li><a href="twomean-packages-data.html#twomean_packages_data" id="toc-twomean_packages_data">Load packages and import data</a></li>
<li><a href="paired-t-test.html#paired-t-test" id="toc-paired-t-test">Paired <em>t</em>-test</a>
<ul>
<li><a href="paired-t-test.html#calc_diffs" id="toc-calc_diffs">Calculate differences</a></li>
<li><a href="paired-t-test.html#paired_Htest" id="toc-paired_Htest">Hypothesis statement</a></li>
<li><a href="paired-t-test.html#graph_paried" id="toc-graph_paried">A graph to accompany a paired <em>t</em>-test</a></li>
<li><a href="paired-t-test.html#assump_paried" id="toc-assump_paried">Assumptions of the paired <em>t</em>-test</a></li>
<li><a href="paired-t-test.html#conduct_paired" id="toc-conduct_paired">Conduct the test</a></li>
<li><a href="paired-t-test.html#concl_paired" id="toc-concl_paired">Concluding statement</a></li>
</ul></li>
<li><a href="twosamp-ttest.html#twosamp_ttest" id="toc-twosamp_ttest">Two sample <em>t</em>-test</a>
<ul>
<li><a href="twosamp-ttest.html#twosamp_hyp" id="toc-twosamp_hyp">Hypothesis statement</a></li>
<li><a href="twosamp-ttest.html#stats_2samp" id="toc-stats_2samp">A table of descriptive statistics</a></li>
<li><a href="twosamp-ttest.html#graph_2samp" id="toc-graph_2samp">A graph to accompany a 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#twosamp_assump" id="toc-twosamp_assump">Assumptions of the 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#conduct_2samptest" id="toc-conduct_2samptest">Conduct the 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#concl_2samp" id="toc-concl_2samp">Concluding statement</a></li>
</ul></li>
<li><a href="assumpbad-2samp.html#assumpbad_2samp" id="toc-assumpbad_2samp">When assumptions aren’t met</a></li>
</ul></li>
<li><a href="compare-three-more-means.html#compare_three_more_means" id="toc-compare_three_more_means">Comparing means among more than two groups</a>
<ul>
<li><a href="anova-packages-data.html#anova_packages_data" id="toc-anova_packages_data">Load packages and import data</a></li>
<li><a href="do-the-anova.html#do_the_anova" id="toc-do_the_anova">Analysis of variance</a>
<ul>
<li><a href="do-the-anova.html#anova_hyps" id="toc-anova_hyps">Hypothesis statements</a></li>
<li><a href="do-the-anova.html#stats_anova" id="toc-stats_anova">A table of descriptive statistics</a></li>
<li><a href="do-the-anova.html#anova_graph1" id="toc-anova_graph1">Visualize the data</a></li>
<li><a href="do-the-anova.html#assump_anova" id="toc-assump_anova">Assumptions of ANOVA</a></li>
<li><a href="do-the-anova.html#do_anova1" id="toc-do_anova1">Conduct the ANOVA test</a></li>
<li><a href="do-the-anova.html#createanovatable" id="toc-createanovatable">Generate nice ANOVA table</a></li>
<li><a href="do-the-anova.html#calculate-r2-for-the-anova" id="toc-calculate-r2-for-the-anova">Calculate <span class="math inline">\(R^2\)</span> for the ANOVA</a></li>
<li><a href="do-the-anova.html#tukey" id="toc-tukey">Tukey-Kramer post-hoc test</a></li>
<li><a href="do-the-anova.html#vis_tukey" id="toc-vis_tukey">Visualizing post-hoc test results</a></li>
<li><a href="do-the-anova.html#anova_conclusion" id="toc-anova_conclusion">Concluding statement</a></li>
</ul></li>
<li><a href="assumpbad-anova.html#assumpbad_anova" id="toc-assumpbad_anova">When assumptions aren’t met</a></li>
</ul></li>
<li><a href="two-num.html#two_num" id="toc-two_num">Analyzing associations between two numerical variables</a>
<ul>
<li><a href="twonum-packages-data.html#twonum_packages_data" id="toc-twonum_packages_data">Load packages and import data</a></li>
<li><a href="pearson.html#pearson" id="toc-pearson">Pearson correlation analysis</a>
<ul>
<li><a href="pearson.html#pearson_hyp" id="toc-pearson_hyp">Hypothesis statements</a></li>
<li><a href="pearson.html#see_corr" id="toc-see_corr">Visualize the data</a></li>
<li><a href="pearson.html#corr_assumptions" id="toc-corr_assumptions">Assumptions of correlation analysis</a></li>
<li><a href="pearson.html#do_corr" id="toc-do_corr">Conduct the correlation analysis</a></li>
<li><a href="pearson.html#concl_corr" id="toc-concl_corr">Concluding statement</a></li>
</ul></li>
<li><a href="rankcorr.html#rankcorr" id="toc-rankcorr">Rank correlation (Spearman’s correlation)</a>
<ul>
<li><a href="rankcorr.html#hypothesis-statements" id="toc-hypothesis-statements">Hypothesis statements</a></li>
<li><a href="rankcorr.html#spearman_hyp" id="toc-spearman_hyp">Visualize the data</a></li>
<li><a href="rankcorr.html#assum_spear" id="toc-assum_spear">Assumptions of Spearman rank correlation</a></li>
<li><a href="rankcorr.html#conduct_spearman" id="toc-conduct_spearman">Conduct the test</a></li>
<li><a href="rankcorr.html#spear_conclude" id="toc-spear_conclude">Concluding statement</a></li>
</ul></li>
</ul></li>
<li><a href="creating-tables-in-r-markdown.html#creating-tables-in-r-markdown" id="toc-creating-tables-in-r-markdown">Creating tables in R Markdown</a>
<ul>
<li><a href="tables-packages.html#tables_packages" id="toc-tables_packages">Load packages and import data</a>
<ul>
<li><a href="tables-packages.html#skim_tables" id="toc-skim_tables">Formatting output from the <code>skimr</code> package</a></li>
<li><a href="tables-packages.html#stats_nicetable" id="toc-stats_nicetable">A nicely formatted table of descriptive statistics</a></li>
</ul></li>
</ul></li>
<li><a href="checking-assumptions-and-data-transformations.html#checking-assumptions-and-data-transformations" id="toc-checking-assumptions-and-data-transformations">Checking assumptions and data transformations</a>
<ul>
<li><a href="assumptions-packages-data.html#assumptions_packages_data" id="toc-assumptions_packages_data">Load packages and import data</a></li>
<li><a href="checknorm-assum.html#checknorm_assum" id="toc-checknorm_assum">Checking the normality assumption</a>
<ul>
<li><a href="checknorm-assum.html#quantile_plots" id="toc-quantile_plots">Normal quantile plots</a></li>
<li><a href="checknorm-assum.html#shapirottest" id="toc-shapirottest">Shapiro-Wilk test for normality</a></li>
</ul></li>
<li><a href="levenetest.html#levenetest" id="toc-levenetest">Checking the equal-variance assumption</a></li>
<li><a href="transform.html#transform" id="toc-transform">Data transformations</a>
<ul>
<li><a href="transform.html#log_transform" id="toc-log_transform">Log-transform</a></li>
<li><a href="transform.html#zeroes" id="toc-zeroes">Dealing with zeroes</a></li>
<li><a href="transform.html#logbases" id="toc-logbases">Log bases</a></li>
<li><a href="transform.html#back_transform" id="toc-back_transform">Back-transforming log data</a></li>
<li><a href="transform.html#logit_transform" id="toc-logit_transform">Logit transform</a></li>
<li><a href="transform.html#logit_back" id="toc-logit_back">Back-transforming logit data</a></li>
<li><a href="transform.html#when_back" id="toc-when_back">When to back-transform?</a></li>
</ul></li>
</ul></li>
<li><a href="visual-markdown-editor.html#visual-markdown-editor" id="toc-visual-markdown-editor">Visual Markdown Editor</a>
<ul>
<li><a href="a-more-familiar-editing-environment.html#a-more-familiar-editing-environment" id="toc-a-more-familiar-editing-environment">A more familiar editing environment</a></li>
</ul></li>
<li><a href="common-errors-and-their-solutions.html#common-errors-and-their-solutions" id="toc-common-errors-and-their-solutions">Common errors and their solutions</a>
<ul>
<li><a href="google-can-help.html#google-can-help" id="toc-google-can-help">Google can help</a></li>
<li><a href="rtools-required-during-install.html#rtools-required-during-install" id="toc-rtools-required-during-install">Rtools required during install</a></li>
<li><a href="could-not-find-function.html#could-not-find-function" id="toc-could-not-find-function">Could not find function</a></li>
<li><a href="there-is-no-package.html#there-is-no-package" id="toc-there-is-no-package">There is no package</a></li>
<li><a href="trying-to-use-cran-without-setting-a-mirror.html#trying-to-use-cran-without-setting-a-mirror" id="toc-trying-to-use-cran-without-setting-a-mirror">Trying to use CRAN without setting a mirror</a></li>
<li><a href="pdf-latex-is-not-found.html#pdf-latex-is-not-found" id="toc-pdf-latex-is-not-found">PDF Latex is not found</a></li>
<li><a href="error-in-parse.html#error-in-parse" id="toc-error-in-parse">Error in parse</a></li>
<li><a href="no-such-file-or-directory-exists.html#no-such-file-or-directory-exists" id="toc-no-such-file-or-directory-exists">No such file or directory exists</a></li>
<li><a href="messy-output-when-loading-packages.html#messy-output-when-loading-packages" id="toc-messy-output-when-loading-packages">Messy output when loading packages</a></li>
<li><a href="unused-argument.html#unused-argument" id="toc-unused-argument">Unused argument</a></li>
<li><a href="object-not-found.html#object-not-found" id="toc-object-not-found">Object not found</a></li>
<li><a href="figure-caption-doesnt-show-up-below-figure-in-knitted-document.html#figure-caption-doesnt-show-up-below-figure-in-knitted-document" id="toc-figure-caption-doesnt-show-up-below-figure-in-knitted-document">Figure caption doesn’t show up below figure in knitted document</a></li>
<li><a href="filename-directory-name-or-volume-label-syntax-is-incorrect.html#filename-directory-name-or-volume-label-syntax-is-incorrect" id="toc-filename-directory-name-or-volume-label-syntax-is-incorrect">Filename, directory name, or volume label syntax is incorrect</a></li>
<li><a href="installing-packages-there-is-a-binary-version-available.html#installing-packages-there-is-a-binary-version-available" id="toc-installing-packages-there-is-a-binary-version-available">Installing packages: there is a binary version available</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorials for BIOL202: Introduction to Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="vis2_2cat" class="section level2">
<h2>Visualizing association between two categorical variables</h2>
<p>We’ll cover three ways to visualize associations between two categorical variables:</p>
<ul>
<li>a <strong>contingency table</strong></li>
<li>a <strong>grouped bar graph</strong></li>
<li>a <strong>mosaic plot</strong></li>
</ul>
<div id="vis2_cont_table" class="section level3">
<h3>Constructing a contingency table</h3>
<div class="note">
<p><strong>New tool</strong>
The <code>tabyl</code> function from the <code>janitor</code> package is useful for creating contingency tables, or more generally, cross-tabulating frequencies for multiple categorical variables.</p>
</div>
<p>You can check out more about the <code>tabyl</code> function at this <a href="https://cran.r-project.org/web/packages/janitor/vignettes/tabyls.html">vignette</a>.</p>
<p>Let’s use the <code>bird.malaria</code> dataset for our demonstration.</p>
<p>If you got an overview of the dataset, as suggested as part of the activity in the preceding section, you would have seen that the <code>bird.malaria</code> tibble includes two categorical variables: <code>treatment</code> and <code>response</code>, each with 2 categories.</p>
<p>The dataset includes 65 rows. Each row corresponds to an individual (unique) bird. Thirty of the birds were randomly assigned to the “Control” treatment group, and 35 were randomly assigned to the “Egg removal” treatment group.</p>
<p>The <code>response</code> variable includes the categories “Malaria” and “No Malaria”, indicating whether the bird contracted Malaria after the treatment.</p>
<p>Our goal is to visualize the frequency of birds that fall into each of the four unique combinations of category:</p>
<ul>
<li>Control + No Malaria</li>
<li>Control + Malaria</li>
<li>Egg removal + No Malaria</li>
<li>Egg removal + Malaria</li>
</ul>
<p>More specifically, we are interested in comparing the incidence of malaria among the Control and Egg removal treatment groups. We’ll learn in a later tutorial how to conduct this comparison statistically.</p>
<p>Let’s provide the code, then explain after. We’ll again make use of the <code>kable</code> function from the <code>knitr</code> package to help present a nice table. So first we create the table (“bird.malaria.table”), then in a later code chunk we’ll output a nice version of the table using the <code>kable</code> function.</p>
<p>First create the basic contingency table:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="vis2-2cat.html#cb69-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.freq <span class="ot">&lt;-</span> bird.malaria <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="vis2-2cat.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(treatment, response)</span></code></pre></div>
<p>Code explanation:</p>
<ul>
<li>the first line is telling R to assign any output from our commands to the object called “bird.malaria.freq”</li>
<li>the first line is also telling R that we’re using the <code>bird.malaria</code> object as input to our subsequent functions, and the pipe (%&gt;%) tells R there’s more to come.</li>
<li>the second line uses the <code>tabyl</code> function, and we provide it with the names of the variables from the <code>bird.malaria</code> object that we want to use for tabulating frequencies. Here we provide the variable names “treatment”, and “response”</li>
</ul>
<p>Let’s look at the table:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="vis2-2cat.html#cb70-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.freq</span></code></pre></div>
<pre><code>##    treatment Malaria No Malaria
##      Control       7         28
##  Egg removal      15         15</code></pre>
<p>It is typically a good idea to also include the row and column totals in a contingency table.</p>
<p>To do this, we use the <code>adorn_totals</code> function, from the <code>janitor</code> package, as follows, and we’ll create a new object called “bird.malaria.freq.totals”:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="vis2-2cat.html#cb72-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.freq.totals <span class="ot">&lt;-</span> bird.malaria <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="vis2-2cat.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(treatment, response) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="vis2-2cat.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="fu">c</span>(<span class="st">&quot;row&quot;</span>, <span class="st">&quot;col&quot;</span>))</span></code></pre></div>
<ul>
<li>the last line tells the <code>adorn_totals</code> function that we want to add the row and column totals to our table</li>
</ul>
<p>Now let’s see what the table looks like before using the <code>kable</code> function. To do this, just provide the name of the object:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="vis2-2cat.html#cb73-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.freq.totals</span></code></pre></div>
<pre><code>##    treatment Malaria No Malaria Total
##      Control       7         28    35
##  Egg removal      15         15    30
##        Total      22         43    65</code></pre>
<p>Now let’s use the <code>kable</code> function to improve the look, and add a table heading.</p>
<div class="note">
<p><strong>NOTE</strong>
We are still finalizing the tutorial describing how to provide a Table heading.</p>
</div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="vis2-2cat.html#cb75-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.freq.totals <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="vis2-2cat.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;Contingency table showing the incidence of malaria in female great tits in relation to experimental treatment&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption>
(#tab:vis2_malaria)Contingency table showing the incidence of malaria in female great tits in relation to experimental treatment
</caption>
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
Malaria
</th>
<th style="text-align:right;">
No Malaria
</th>
<th style="text-align:right;">
Total
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
Egg removal
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
65
</td>
</tr>
</tbody>
</table>
<p><strong>Relative frequencies</strong></p>
<p>Often it is useful to also present a contingency table that shows the <em>relative frequencies</em>. However, it’s important to know how to calculate those relative frequencies.</p>
<p>For instance, recall that in this malaria example, we are interested in comparing the incidence of malaria among the Control and Egg removal treatment groups. Thus, we should calculate the relative frequencies using the <strong>row totals</strong>. This will become clear when we show the table.</p>
<p>We can get relative frequencies, which are equivalent to <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Proportion">proportions</a>, using the <code>adorn_percentages</code> function (the function name is a misnomer, because we’re calculating proportions, not percentages!), and telling R to use the row totals for the calculations.</p>
<p>First create the new table object “bird.malaria.prop”:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="vis2-2cat.html#cb76-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.prop <span class="ot">&lt;-</span> bird.malaria <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="vis2-2cat.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(treatment, response) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="vis2-2cat.html#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_percentages</span>(<span class="st">&quot;row&quot;</span>)</span></code></pre></div>
<p>Now present it using <code>kable</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="vis2-2cat.html#cb77-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.prop <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="vis2-2cat.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;Contingency table showing the relative frequency of malaria in female great tits in relation to experimental treatment&quot;</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption>
(#tab:vis2_malaria_prop)Contingency table showing the relative frequency of malaria in female great tits in relation to experimental treatment
</caption>
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:right;">
Malaria
</th>
<th style="text-align:right;">
No Malaria
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Egg removal
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
</div>
<div id="grouped_bar_graphs" class="section level3">
<h3>Constructing a grouped bar graph</h3>
<p>To construct a grouped bar graph, we first need <em>wrangle</em> (reformat) the data to be in the form of a <a href="vis-cat-freq-table.html#vis_cat_freq_table"><strong>frequency table</strong></a>.</p>
<p>Let’s revisit what the <code>bird.malaria</code> tibble looks like:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="vis2-2cat.html#cb78-1" aria-hidden="true" tabindex="-1"></a>bird.malaria</span></code></pre></div>
<pre><code>## # A tibble: 65 × 3
##     bird treatment   response
##    &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;   
##  1     1 Control     Malaria 
##  2     2 Control     Malaria 
##  3     3 Control     Malaria 
##  4     4 Control     Malaria 
##  5     5 Control     Malaria 
##  6     6 Control     Malaria 
##  7     7 Control     Malaria 
##  8     8 Egg removal Malaria 
##  9     9 Egg removal Malaria 
## 10    10 Egg removal Malaria 
## # … with 55 more rows</code></pre>
<p>To wrangle this into the appropriate format, here’s the appropriate code:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="vis2-2cat.html#cb80-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.tidy <span class="ot">&lt;-</span> bird.malaria <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="vis2-2cat.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="vis2-2cat.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(response)</span></code></pre></div>
<p>This is similar to what you learned in a <a href="vis-cat-freq-table.html#vis_cat_freq_table">previous tutorial</a>, but here we’ve added a new function!</p>
<div class="note">
<p><strong>New tool</strong>
The <code>group_by</code> function from the <code>dplyr</code> package enables one to apply a function to each category of a categorical variable. See more help using “?group_by”.</p>
</div>
<p>In the preceding code chunk, we’re tallying the observations in the two “treatment” variable categories, but also keeping track of which category of “response” the individual belongs to.</p>
<p>Let’s have a look at the result:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="vis2-2cat.html#cb81-1" aria-hidden="true" tabindex="-1"></a>bird.malaria.tidy</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
## # Groups:   treatment [2]
##   treatment   response       n
##   &lt;chr&gt;       &lt;chr&gt;      &lt;int&gt;
## 1 Control     Malaria        7
## 2 Control     No Malaria    28
## 3 Egg removal Malaria       15
## 4 Egg removal No Malaria    15</code></pre>
<p>We now have what we need for a grouped bar chart, using the <code>ggplot</code> function:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="vis2-2cat.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> bird.malaria.tidy, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> n, <span class="at">fill =</span> response)) <span class="sc">+</span> </span>
<span id="cb83-2"><a href="vis2-2cat.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> </span>
<span id="cb83-3"><a href="vis2-2cat.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-4"><a href="vis2-2cat.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Treatment group&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-5"><a href="vis2-2cat.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="BIOL202_files/figure-html/malaria_barchart1-1.png" width="672" /></p>
<p>This code is similar to what we used <a href="vis-cat-barchart.html#vis_cat_barchart">previously to create a bar graph</a>, but there are two key differences:</p>
<ul>
<li>in the first line within the <code>aes</code> function, we include a new argument <code>fill = response</code>, telling R to use different bar fill colours based on the categories in the “response” variable.<br />
</li>
<li>in the second line, we provide a new argument to the <code>geom_bar</code> function: <code>position = position_dodge()</code>, which tells R to use separate bars for each category of the “fill” variable (if we did not include this argument, we’d get a “stacked bar graph” instead)</li>
</ul>
<div class="note">
<p><strong>Note</strong>
It is best practice to use the <strong>response variable</strong> as the “fill” variable in a grouped bar graph, as we have done in the malaria example.</p>
</div>
<p>If we wished to provide an appropriate figure heading, this would be the code:</p>
<div class="figure"><span id="fig:unnamed-chunk-36"></span>
<img src="more/grouped_bar_graph.png" alt="Example code chunk for producing a good grouped bar graph" width="1053" />
<p class="caption">
Figure 11: Example code chunk for producing a good grouped bar graph
</p>
</div>
<p>And the result:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="vis2-2cat.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> bird.malaria.tidy, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> n, <span class="at">fill =</span> response)) <span class="sc">+</span> </span>
<span id="cb84-2"><a href="vis2-2cat.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> </span>
<span id="cb84-3"><a href="vis2-2cat.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="vis2-2cat.html#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Treatment group&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-5"><a href="vis2-2cat.html#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-37"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-37-1.png" alt="Grouped bar graph showing the incidence of malaria in female great tits in relation to control (N = 35) and Egg-removal (N = 30) treatment groups." width="384" />
<p class="caption">
Figure 12: Grouped bar graph showing the incidence of malaria in female great tits in relation to control (N = 35) and Egg-removal (N = 30) treatment groups.
</p>
</div>
</div>
<div id="mosaic_plot" class="section level3">
<h3>Constructing a mosaic plot</h3>
<p>An alternative and often more effective way to visualize the association between two categorical variables is a <strong>mosaic plot</strong>.</p>
<p>For this we use the <code>geom_mosaic</code> function, from the <code>ggmosaic</code> package, in conjunction with the <code>ggplot</code> function.</p>
<p>For more information about the <code>ggmosaic</code> package, see this <a href="https://cran.r-project.org/web/packages/ggmosaic/vignettes/ggmosaic.html">vignette</a>.</p>
<p>For the <code>geom_mosaic</code> function, we actually use the original (raw) <code>bird.malaria</code> tibble, which has a row for every observation (i.e. it isn’t summarized first into a frequency table).</p>
<p>Here’s the code, and we’ll explain after:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="vis2-2cat.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> bird.malaria) <span class="sc">+</span></span>
<span id="cb85-2"><a href="vis2-2cat.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(treatment), <span class="at">fill =</span> response)) <span class="sc">+</span></span>
<span id="cb85-3"><a href="vis2-2cat.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Treatment group&quot;</span>) <span class="sc">+</span></span>
<span id="cb85-4"><a href="vis2-2cat.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Relative frequency&quot;</span>)</span></code></pre></div>
<p><img src="BIOL202_files/figure-html/mosaic_malaria1-1.png" width="672" /></p>
<p>In the code chunk above we see one key difference from previous uses of the <code>ggplot</code> function is that the <code>aes</code> function is not provided in the arguments to <code>ggplot</code> in the first line, but is instead provided to the arguments of the <code>geom_mosaic</code> function on the second line.</p>
<p>We also see <code>product(treatment)</code>, which is difficult to explain, so suffice it to say that it’s telling the <code>geom_mosaic</code> function to calculate relative frequencies based on the “treatment” variable, and in conjunction with the fill variable “response”.</p>
<p>Note that in the mosaic plot there are no number values provided on the y-axis. This is OK: as you can see, the difference in the relative frequency of malaria incidence across the treatment groups is obvious, and that’s the goal of this type of graph, i.e. to visualize any differences in relative frequency across groups. One doesn’t need y-axis numbers because it’s the comparison across groups that is the focus. Nevertheless, the y-axis limits would be zero and one, so one can “eyeball” the relative frequencies for each group. We’ll learn about interpreting mosaic plots soon.</p>
<ol style="list-style-type: decimal">
<li>Using the <code>penguins</code> dataset, try creating a mosaic plot for comparing the relative frequency of penguins belonging to the three different “species” across the three different islands (variable “island”).</li>
</ol>
</div>
<div id="interpret_mosaic" class="section level3">
<h3>Interpreting mosaic plots</h3>
<p>Let’s provide the mosaic plot again, and this time we’ll provide an appropriate figure heading in the chunk header, as we <a href="rmd-graphing.html#rmd_graphing">learned previously</a>:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="vis2-2cat.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> bird.malaria) <span class="sc">+</span></span>
<span id="cb86-2"><a href="vis2-2cat.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(treatment), <span class="at">fill =</span> response)) <span class="sc">+</span></span>
<span id="cb86-3"><a href="vis2-2cat.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Treatment group&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-4"><a href="vis2-2cat.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Relative frequency&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-38"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-38-1.png" alt="Relative frequency of the incidence of malaria in female great tits in relation to control (N = 35) and Egg-removal (N = 30) treatment groups." width="384" />
<p class="caption">
Figure 13: Relative frequency of the incidence of malaria in female great tits in relation to control (N = 35) and Egg-removal (N = 30) treatment groups.
</p>
</div>
<p>Here’s the code:</p>
<div class="figure"><span id="fig:unnamed-chunk-39"></span>
<img src="more/mosaic_graph.png" alt="Example code chunk for producing a good mosaic plot" width="1312" />
<p class="caption">
Figure 14: Example code chunk for producing a good mosaic plot
</p>
</div>
<p>When interpreting a mosaic plot, the key is to look how the relative frequency of the categories of the response variable - denoted by the “fill” colours - varies across the explanatory variable, which is arranged on the x-axis.</p>
<p>For example, in the malaria example above:</p>
<p>“The mosaic plot shows that the incidence (or relative frequency) of malaria is comparatively greater among birds in the egg removal treatment group compared to the control group. Only about 20% of birds in the control group contracted malaria, whereas 50% of the birds in the the egg-removal group contracted malaria.”</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vis2-packages-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="two-numeric.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highight": true,
"download": ["pdf", "epub"]
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
