<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12.3 An hypothesis test example | Tutorials for BIOL202: Introduction to Biostatistics</title>
  <meta name="description" content="All tutorials associated with BIOL202" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="12.3 An hypothesis test example | Tutorials for BIOL202: Introduction to Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="All tutorials associated with BIOL202" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12.3 An hypothesis test example | Tutorials for BIOL202: Introduction to Biostatistics" />
  
  <meta name="twitter:description" content="All tutorials associated with BIOL202" />
  

<meta name="author" content="Jason Pither" />


<meta name="date" content="2022-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hyp-steps.html"/>
<link rel="next" href="single-cat.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DVMYRT2ND2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DVMYRT2ND2');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOL202 Tutorials</a></li>

<li class="divider"></li>
<li><a href="#part-preface" id="toc-part-preface">(PART*) Preface</a></li>
<li><a href="index.html#welcome" id="toc-welcome">Welcome</a>
<ul>
<li><a href="author.html#author" id="toc-author">Author</a></li>
<li><a href="acknowledgments.html#acknowledgments" id="toc-acknowledgments">Acknowledgments</a></li>
<li><a href="copyright.html#copyright" id="toc-copyright">Copyright</a></li>
<li><a href="ubco-biology-open-materials.html#ubco-biology-open-materials" id="toc-ubco-biology-open-materials">UBCO Biology open materials</a></li>
</ul></li>
<li><a href="#part-getting-started-with-r-rstudio-r-markdown" id="toc-part-getting-started-with-r-rstudio-r-markdown">(PART*) Getting started with R, RStudio &amp; R Markdown</a></li>
<li><a href="what-is-R.html#what_is_R" id="toc-what_is_R"><span class="toc-section-number">1</span> What are R and RStudio?</a></li>
<li><a href="install-R-Rstudio.html#install_R_Rstudio" id="toc-install_R_Rstudio"><span class="toc-section-number">2</span> Installing R and RStudio</a></li>
<li><a href="start-r.html#start_r" id="toc-start_r"><span class="toc-section-number">3</span> Start using R &amp; RStudio</a>
<ul>
<li><a href="Rstudio-interface.html#Rstudio_interface" id="toc-Rstudio_interface"><span class="toc-section-number">3.1</span> The RStudio Interface</a></li>
<li><a href="coding-basics.html#coding_basics" id="toc-coding_basics"><span class="toc-section-number">3.2</span> Coding basics</a></li>
</ul></li>
<li><a href="packages.html#packages" id="toc-packages"><span class="toc-section-number">4</span> R packages</a>
<ul>
<li><a href="package-install.html#package_install" id="toc-package_install"><span class="toc-section-number">4.1</span> Package installation</a></li>
<li><a href="package-load.html#package_load" id="toc-package_load"><span class="toc-section-number">4.2</span> Package loading</a></li>
</ul></li>
<li><a href="intro-markdown.html#intro_markdown" id="toc-intro_markdown"><span class="toc-section-number">5</span> Intro to R Markdown</a>
<ul>
<li><a href="lit-programming.html#lit_programming" id="toc-lit_programming"><span class="toc-section-number">5.1</span> Literate programming with R Markdown</a></li>
<li><a href="veryify-knit.html#veryify_knit" id="toc-veryify_knit"><span class="toc-section-number">5.2</span> Making sure R Markdown knits to PDF</a></li>
</ul></li>
<li><a href="r-resources.html#r_resources" id="toc-r_resources"><span class="toc-section-number">6</span> Extra resources</a>
<ul>
<li><a href="online-resources.html#online_resources" id="toc-online_resources"><span class="toc-section-number">6.1</span> R Resources Online</a></li>
<li><a href="rmd-graphing.html#rmd_graphing" id="toc-rmd_graphing"><span class="toc-section-number">6.2</span> Setting up R Markdown for graphing</a></li>
<li><a href="example-answer.html#example_answer" id="toc-example_answer"><span class="toc-section-number">6.3</span> Example question / answer</a></li>
<li><a href="knit-assign.html#knit_assign" id="toc-knit_assign"><span class="toc-section-number">6.4</span> Knitting your assignment to PDF</a></li>
<li><a href="submit-rmd.html#submit_rmd" id="toc-submit_rmd"><span class="toc-section-number">6.5</span> Submit your assignment</a></li>
</ul></li>
<li><a href="data-import.html#data_import" id="toc-data_import"><span class="toc-section-number">7</span> Preparing and importing Tidy Data</a>
<ul>
<li><a href="tidy-data.html#tidy_data" id="toc-tidy_data"><span class="toc-section-number">7.1</span> Tidy data</a></li>
<li><a href="import-csv-url.html#import_csv_url" id="toc-import_csv_url"><span class="toc-section-number">7.2</span> Import a CSV file from a website</a></li>
<li><a href="create-csv-local.html#create_csv_local" id="toc-create_csv_local"><span class="toc-section-number">7.3</span> Create a CSV file</a></li>
<li><a href="import-csv-local.html#import_csv_local" id="toc-import_csv_local"><span class="toc-section-number">7.4</span> Import a local CSV file</a></li>
<li><a href="data-overview.html#data_overview" id="toc-data_overview"><span class="toc-section-number">7.5</span> Get an overview of a dataset</a></li>
<li><a href="tutorial-practice-activities.html#tutorial-practice-activities" id="toc-tutorial-practice-activities"><span class="toc-section-number">7.6</span> Tutorial practice activities</a></li>
</ul></li>
<li><a href="#part-visualizing-and-describing-data" id="toc-part-visualizing-and-describing-data">(PART*) Visualizing and Describing Data</a></li>
<li><a href="vis-variable.html#vis_variable" id="toc-vis_variable"><span class="toc-section-number">8</span> Visualizing a single variable</a>
<ul>
<li><a href="vis-packages-data.html#vis_packages_data" id="toc-vis_packages_data"><span class="toc-section-number">8.1</span> Load packages and import data</a></li>
<li><a href="vis-data-overview.html#vis_data_overview" id="toc-vis_data_overview"><span class="toc-section-number">8.2</span> Get an overview of the data</a></li>
<li><a href="vis-cat-freq-table.html#vis_cat_freq_table" id="toc-vis_cat_freq_table"><span class="toc-section-number">8.3</span> Create a frequency table</a></li>
<li><a href="vis-cat-barchart.html#vis_cat_barchart" id="toc-vis_cat_barchart"><span class="toc-section-number">8.4</span> Create a bar graph</a></li>
<li><a href="vis-histogram.html#vis_histogram" id="toc-vis_histogram"><span class="toc-section-number">8.5</span> Create a histogram</a></li>
<li><a href="vis-describe-hist.html#vis_describe_hist" id="toc-vis_describe_hist"><span class="toc-section-number">8.6</span> Describing a histogram</a></li>
</ul></li>
<li><a href="vis-describe.html#vis_describe" id="toc-vis_describe"><span class="toc-section-number">9</span> Describing a single variable</a>
<ul>
<li><a href="desc-packages-data.html#desc_packages_data" id="toc-desc_packages_data"><span class="toc-section-number">9.1</span> Load packages and import data</a></li>
<li><a href="desc-cat-Var.html#desc_cat_Var" id="toc-desc_cat_Var"><span class="toc-section-number">9.2</span> Describing a categorical variable</a></li>
<li><a href="desc-numeric-var.html#desc_numeric_var" id="toc-desc_numeric_var"><span class="toc-section-number">9.3</span> Describing a numerical variable</a>
<ul>
<li><a href="desc-numeric-var.html#median_IQR" id="toc-median_IQR"><span class="toc-section-number">9.3.1</span> Calculating the median &amp; IQR</a></li>
<li><a href="desc-numeric-var.html#mean_sd" id="toc-mean_sd"><span class="toc-section-number">9.3.2</span> Calculating the mean &amp; standard deviation</a></li>
</ul></li>
<li><a href="desc-numeric-var-cat.html#desc_numeric_var_cat" id="toc-desc_numeric_var_cat"><span class="toc-section-number">9.4</span> Describing a numerical variable grouped by a categorical variable</a></li>
</ul></li>
<li><a href="vis-twovar.html#vis_twovar" id="toc-vis_twovar"><span class="toc-section-number">10</span> Visualizing associations between two variables</a>
<ul>
<li><a href="vis2-packages-data.html#vis2_packages_data" id="toc-vis2_packages_data"><span class="toc-section-number">10.1</span> Load packages and import data</a></li>
<li><a href="vis2-2cat.html#vis2_2cat" id="toc-vis2_2cat"><span class="toc-section-number">10.2</span> Visualizing association between two categorical variables</a>
<ul>
<li><a href="vis2-2cat.html#vis2_cont_table" id="toc-vis2_cont_table"><span class="toc-section-number">10.2.1</span> Constructing a contingency table</a></li>
<li><a href="vis2-2cat.html#grouped_bar_graphs" id="toc-grouped_bar_graphs"><span class="toc-section-number">10.2.2</span> Constructing a grouped bar graph</a></li>
<li><a href="vis2-2cat.html#mosaic_plot" id="toc-mosaic_plot"><span class="toc-section-number">10.2.3</span> Constructing a mosaic plot</a></li>
<li><a href="vis2-2cat.html#interpret_mosaic" id="toc-interpret_mosaic"><span class="toc-section-number">10.2.4</span> Interpreting mosaic plots</a></li>
</ul></li>
<li><a href="two-numeric.html#two_numeric" id="toc-two_numeric"><span class="toc-section-number">10.3</span> Visualizing association between two numeric variables</a>
<ul>
<li><a href="two-numeric.html#interpret_scatter" id="toc-interpret_scatter"><span class="toc-section-number">10.3.1</span> Interpreting and describing a scatterplot</a></li>
</ul></li>
<li><a href="numeric-vs-cat.html#numeric_vs_cat" id="toc-numeric_vs_cat"><span class="toc-section-number">10.4</span> Visualizing association between a numeric and a categorical variable</a>
<ul>
<li><a href="numeric-vs-cat.html#stripchart" id="toc-stripchart"><span class="toc-section-number">10.4.1</span> Create a stripchart</a></li>
<li><a href="numeric-vs-cat.html#violinplot" id="toc-violinplot"><span class="toc-section-number">10.4.2</span> Create a violin plot</a></li>
<li><a href="numeric-vs-cat.html#boxplots" id="toc-boxplots"><span class="toc-section-number">10.4.3</span> Creating a boxplot</a></li>
<li><a href="numeric-vs-cat.html#bestplot" id="toc-bestplot"><span class="toc-section-number">10.4.4</span> Combining violin and boxplots</a></li>
<li><a href="numeric-vs-cat.html#interp_violin" id="toc-interp_violin"><span class="toc-section-number">10.4.5</span> Interpreting stripcharts and boxplots</a></li>
</ul></li>
</ul></li>
<li><a href="#part-inferential-statistics" id="toc-part-inferential-statistics">(PART*) Inferential Statistics</a></li>
<li><a href="estimation.html#estimation" id="toc-estimation"><span class="toc-section-number">11</span> Sampling, Estimation, &amp; Uncertainty</a>
<ul>
<li><a href="estimation-packages-data.html#estimation_packages_data" id="toc-estimation_packages_data"><span class="toc-section-number">11.1</span> Load packages and import data</a></li>
<li><a href="sampling-functions.html#sampling_functions" id="toc-sampling_functions"><span class="toc-section-number">11.2</span> Functions for sampling</a>
<ul>
<li><a href="sampling-functions.html#setseed" id="toc-setseed"><span class="toc-section-number">11.2.1</span> Setting the “seed” for random sampling</a></li>
</ul></li>
<li><a href="sampling-error.html#sampling_error" id="toc-sampling_error"><span class="toc-section-number">11.3</span> Sampling error</a></li>
<li><a href="sampdistmean.html#sampdistmean" id="toc-sampdistmean"><span class="toc-section-number">11.4</span> Sampling distribution of the mean</a>
<ul>
<li><a href="sampdistmean.html#hist_samdist" id="toc-hist_samdist"><span class="toc-section-number">11.4.1</span> Visualize the sampling distribution</a></li>
</ul></li>
<li><a href="sem-page.html#sem_page" id="toc-sem_page"><span class="toc-section-number">11.5</span> Standard error of the mean</a></li>
<li><a href="confint-rough.html#confint_rough" id="toc-confint_rough"><span class="toc-section-number">11.6</span> Rule of thumb 95% confidence interval</a></li>
</ul></li>
<li><a href="hypothesis.html#hypothesis" id="toc-hypothesis"><span class="toc-section-number">12</span> Hypothesis testing</a>
<ul>
<li><a href="hyp-packages-data.html#hyp_packages_data" id="toc-hyp_packages_data"><span class="toc-section-number">12.1</span> Load packages and import data</a></li>
<li><a href="hyp-steps.html#hyp_steps" id="toc-hyp_steps"><span class="toc-section-number">12.2</span> Steps to hypothesis testing</a></li>
<li><a href="hyp-example.html#hyp_example" id="toc-hyp_example"><span class="toc-section-number">12.3</span> An hypothesis test example</a>
<ul>
<li><a href="hyp-example.html#follow_hyp_steps" id="toc-follow_hyp_steps"><span class="toc-section-number">12.3.1</span> Following the steps to hypothesis testing</a></li>
<li><a href="hyp-example.html#sim_null" id="toc-sim_null"><span class="toc-section-number">12.3.2</span> Simulating a “null distribution”</a></li>
<li><a href="hyp-example.html#calc_p" id="toc-calc_p"><span class="toc-section-number">12.3.3</span> Calculating the <em>P</em>-value</a></li>
<li><a href="hyp-example.html#concluding_statement" id="toc-concluding_statement"><span class="toc-section-number">12.3.4</span> Writing a concluding statement</a></li>
</ul></li>
</ul></li>
<li><a href="single-cat.html#single_cat" id="toc-single_cat"><span class="toc-section-number">13</span> Analyzing a single categorical variable</a>
<ul>
<li><a href="singcat-packages-data.html#singcat_packages_data" id="toc-singcat_packages_data"><span class="toc-section-number">13.1</span> Load packages and import data</a></li>
<li><a href="estproportions.html#estproportions" id="toc-estproportions"><span class="toc-section-number">13.2</span> Estimating proportions</a>
<ul>
<li><a href="estproportions.html#sterr_prop" id="toc-sterr_prop"><span class="toc-section-number">13.2.1</span> Standard error for a proportion</a></li>
<li><a href="estproportions.html#confint_prop" id="toc-confint_prop"><span class="toc-section-number">13.2.2</span> Confidence interval for a proportion</a></li>
</ul></li>
<li><a href="binomdist.html#binomdist" id="toc-binomdist"><span class="toc-section-number">13.3</span> Binomial distribution</a></li>
<li><a href="binom-test.html#binom_test" id="toc-binom_test"><span class="toc-section-number">13.4</span> Binomial test</a></li>
<li><a href="prophypconf.html#prophypconf" id="toc-prophypconf"><span class="toc-section-number">13.5</span> Confidence interval approach to hypothesis testing</a></li>
<li><a href="GOF-test.html#GOF_test" id="toc-GOF_test"><span class="toc-section-number">13.6</span> Goodness-of-fit tests</a></li>
</ul></li>
<li><a href="two-cat.html#two_cat" id="toc-two_cat"><span class="toc-section-number">14</span> Analyzing associations between two categorical variables</a>
<ul>
<li><a href="twocat-packages-data.html#twocat_packages_data" id="toc-twocat_packages_data"><span class="toc-section-number">14.1</span> Load packages and import data</a></li>
<li><a href="fishertest.html#fishertest" id="toc-fishertest"><span class="toc-section-number">14.2</span> Fisher’s Exact Test</a>
<ul>
<li><a href="fishertest.html#fisher_hyp" id="toc-fisher_hyp"><span class="toc-section-number">14.2.1</span> Hypothesis statement</a></li>
<li><a href="fishertest.html#show_cont_table" id="toc-show_cont_table"><span class="toc-section-number">14.2.2</span> Display a contingency table</a></li>
<li><a href="fishertest.html#show_mosaic" id="toc-show_mosaic"><span class="toc-section-number">14.2.3</span> Display a mosaic plot</a></li>
<li><a href="fishertest.html#do_fisher" id="toc-do_fisher"><span class="toc-section-number">14.2.4</span> Conduct the Fisher’s Exact Test</a></li>
</ul></li>
<li><a href="odds.html#odds" id="toc-odds"><span class="toc-section-number">14.3</span> Estimate the Odds of getting sick</a></li>
<li><a href="oddsratio.html#oddsratio" id="toc-oddsratio"><span class="toc-section-number">14.4</span> Estimate the odds ratio</a></li>
<li><a href="chisquare.html#chisquare" id="toc-chisquare"><span class="toc-section-number">14.5</span> <span class="math inline">\(\chi\)</span><sup>2</sup> Contingency Test</a>
<ul>
<li><a href="chisquare.html#chihyp" id="toc-chihyp"><span class="toc-section-number">14.5.1</span> Hypothesis statement</a></li>
<li><a href="chisquare.html#showwormcont" id="toc-showwormcont"><span class="toc-section-number">14.5.2</span> Display the contingency table</a></li>
<li><a href="chisquare.html#mosaicworm" id="toc-mosaicworm"><span class="toc-section-number">14.5.3</span> Visualize a mosaic plot</a></li>
<li><a href="chisquare.html#checkchiassum" id="toc-checkchiassum"><span class="toc-section-number">14.5.4</span> Check the assumptions</a></li>
<li><a href="chisquare.html#chiresults" id="toc-chiresults"><span class="toc-section-number">14.5.5</span> Get the results of the test</a></li>
</ul></li>
</ul></li>
<li><a href="single-numeric.html#single_numeric" id="toc-single_numeric"><span class="toc-section-number">15</span> Analyzing a single numerical variable</a>
<ul>
<li><a href="singlenum-packages-data.html#singlenum_packages_data" id="toc-singlenum_packages_data"><span class="toc-section-number">15.1</span> Load packages and import data</a></li>
<li><a href="onesamp-t-test.html#onesamp_t_test" id="toc-onesamp_t_test"><span class="toc-section-number">15.2</span> One-sample <em>t</em>-test</a>
<ul>
<li><a href="onesamp-t-test.html#onesamp_hyp" id="toc-onesamp_hyp"><span class="toc-section-number">15.2.1</span> Hypothesis statement</a></li>
<li><a href="onesamp-t-test.html#onesamp_assumptions" id="toc-onesamp_assumptions"><span class="toc-section-number">15.2.2</span> Assumptions of one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_graph" id="toc-onesamp_graph"><span class="toc-section-number">15.2.3</span> A graph to accompany a one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_test" id="toc-onesamp_test"><span class="toc-section-number">15.2.4</span> Conduct the one-sample <em>t</em>-test</a></li>
<li><a href="onesamp-t-test.html#onesamp_conclude" id="toc-onesamp_conclude"><span class="toc-section-number">15.2.5</span> Concluding statement for the one-sample <em>t</em>-test</a></li>
</ul></li>
<li><a href="t-confidence.html#t_confidence" id="toc-t_confidence"><span class="toc-section-number">15.3</span> Confidence intervals for <span class="math inline">\(\mu\)</span></a>
<ul>
<li><a href="t-confidence.html#conf_precision" id="toc-conf_precision"><span class="toc-section-number">15.3.1</span> Confidence interval as a measure of precision for an estimate</a></li>
<li><a href="t-confidence.html#conf_hyp" id="toc-conf_hyp"><span class="toc-section-number">15.3.2</span> Confidence interval approach to hypothesis testing</a></li>
</ul></li>
</ul></li>
<li><a href="compare-two-means.html#compare_two_means" id="toc-compare_two_means"><span class="toc-section-number">16</span> Comparing means among two groups</a>
<ul>
<li><a href="twomean-packages-data.html#twomean_packages_data" id="toc-twomean_packages_data"><span class="toc-section-number">16.1</span> Load packages and import data</a></li>
<li><a href="paired-t-test.html#paired-t-test" id="toc-paired-t-test"><span class="toc-section-number">16.2</span> Paired <em>t</em>-test</a>
<ul>
<li><a href="paired-t-test.html#calc_diffs" id="toc-calc_diffs"><span class="toc-section-number">16.2.1</span> Calculate differences</a></li>
<li><a href="paired-t-test.html#paired_Htest" id="toc-paired_Htest"><span class="toc-section-number">16.2.2</span> Hypothesis statement</a></li>
<li><a href="paired-t-test.html#graph_paried" id="toc-graph_paried"><span class="toc-section-number">16.2.3</span> A graph to accompany a paired <em>t</em>-test</a></li>
<li><a href="paired-t-test.html#assump_paried" id="toc-assump_paried"><span class="toc-section-number">16.2.4</span> Assumptions of the paired <em>t</em>-test</a></li>
<li><a href="paired-t-test.html#conduct_paired" id="toc-conduct_paired"><span class="toc-section-number">16.2.5</span> Conduct the test</a></li>
<li><a href="paired-t-test.html#concl_paired" id="toc-concl_paired"><span class="toc-section-number">16.2.6</span> Concluding statement</a></li>
</ul></li>
<li><a href="twosamp-ttest.html#twosamp_ttest" id="toc-twosamp_ttest"><span class="toc-section-number">16.3</span> Two sample <em>t</em>-test</a>
<ul>
<li><a href="twosamp-ttest.html#twosamp_hyp" id="toc-twosamp_hyp"><span class="toc-section-number">16.3.1</span> Hypothesis statement</a></li>
<li><a href="twosamp-ttest.html#stats_2samp" id="toc-stats_2samp"><span class="toc-section-number">16.3.2</span> A table of descriptive statistics</a></li>
<li><a href="twosamp-ttest.html#graph_2samp" id="toc-graph_2samp"><span class="toc-section-number">16.3.3</span> A graph to accompany a 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#twosamp_assump" id="toc-twosamp_assump"><span class="toc-section-number">16.3.4</span> Assumptions of the 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#conduct_2samptest" id="toc-conduct_2samptest"><span class="toc-section-number">16.3.5</span> Conduct the 2-sample <em>t</em>-test</a></li>
<li><a href="twosamp-ttest.html#concl_2samp" id="toc-concl_2samp"><span class="toc-section-number">16.3.6</span> Concluding statement</a></li>
</ul></li>
<li><a href="assumpbad-2samp.html#assumpbad_2samp" id="toc-assumpbad_2samp"><span class="toc-section-number">16.4</span> When assumptions aren’t met</a></li>
</ul></li>
<li><a href="compare-three-more-means.html#compare_three_more_means" id="toc-compare_three_more_means"><span class="toc-section-number">17</span> Comparing means among more than two groups</a>
<ul>
<li><a href="anova-packages-data.html#anova_packages_data" id="toc-anova_packages_data"><span class="toc-section-number">17.1</span> Load packages and import data</a></li>
<li><a href="do-the-anova.html#do_the_anova" id="toc-do_the_anova"><span class="toc-section-number">17.2</span> Analysis of variance</a>
<ul>
<li><a href="do-the-anova.html#anova_hyps" id="toc-anova_hyps"><span class="toc-section-number">17.2.1</span> Hypothesis statements</a></li>
<li><a href="do-the-anova.html#stats_anova" id="toc-stats_anova"><span class="toc-section-number">17.2.2</span> A table of descriptive statistics</a></li>
<li><a href="do-the-anova.html#anova_graph1" id="toc-anova_graph1"><span class="toc-section-number">17.2.3</span> Visualize the data</a></li>
<li><a href="do-the-anova.html#assump_anova" id="toc-assump_anova"><span class="toc-section-number">17.2.4</span> Assumptions of ANOVA</a></li>
<li><a href="do-the-anova.html#do_anova1" id="toc-do_anova1"><span class="toc-section-number">17.2.5</span> Conduct the ANOVA test</a></li>
<li><a href="do-the-anova.html#createanovatable" id="toc-createanovatable"><span class="toc-section-number">17.2.6</span> Generate nice ANOVA table</a></li>
<li><a href="do-the-anova.html#calculate-r2-for-the-anova" id="toc-calculate-r2-for-the-anova"><span class="toc-section-number">17.2.7</span> Calculate <span class="math inline">\(R^2\)</span> for the ANOVA</a></li>
<li><a href="do-the-anova.html#tukey" id="toc-tukey"><span class="toc-section-number">17.2.8</span> Tukey-Kramer post-hoc test</a></li>
<li><a href="do-the-anova.html#vis_tukey" id="toc-vis_tukey"><span class="toc-section-number">17.2.9</span> Visualizing post-hoc test results</a></li>
<li><a href="do-the-anova.html#anova_conclusion" id="toc-anova_conclusion"><span class="toc-section-number">17.2.10</span> Concluding statement</a></li>
</ul></li>
<li><a href="assumpbad-anova.html#assumpbad_anova" id="toc-assumpbad_anova"><span class="toc-section-number">17.3</span> When assumptions aren’t met</a></li>
</ul></li>
<li><a href="two-num.html#two_num" id="toc-two_num"><span class="toc-section-number">18</span> Analyzing associations between two numerical variables</a>
<ul>
<li><a href="twonum-packages-data.html#twonum_packages_data" id="toc-twonum_packages_data"><span class="toc-section-number">18.1</span> Load packages and import data</a></li>
<li><a href="pearson.html#pearson" id="toc-pearson"><span class="toc-section-number">18.2</span> Pearson correlation analysis</a>
<ul>
<li><a href="pearson.html#pearson_hyp" id="toc-pearson_hyp"><span class="toc-section-number">18.2.1</span> Hypothesis statements</a></li>
<li><a href="pearson.html#see_corr" id="toc-see_corr"><span class="toc-section-number">18.2.2</span> Visualize the data</a></li>
<li><a href="pearson.html#corr_assumptions" id="toc-corr_assumptions"><span class="toc-section-number">18.2.3</span> Assumptions of correlation analysis</a></li>
<li><a href="pearson.html#do_corr" id="toc-do_corr"><span class="toc-section-number">18.2.4</span> Conduct the correlation analysis</a></li>
<li><a href="pearson.html#concl_corr" id="toc-concl_corr"><span class="toc-section-number">18.2.5</span> Concluding statement</a></li>
</ul></li>
<li><a href="rankcorr.html#rankcorr" id="toc-rankcorr"><span class="toc-section-number">18.3</span> Rank correlation (Spearman’s correlation)</a>
<ul>
<li><a href="rankcorr.html#hypothesis-statements" id="toc-hypothesis-statements"><span class="toc-section-number">18.3.1</span> Hypothesis statements</a></li>
<li><a href="rankcorr.html#spearman_hyp" id="toc-spearman_hyp"><span class="toc-section-number">18.3.2</span> Visualize the data</a></li>
<li><a href="rankcorr.html#assum_spear" id="toc-assum_spear"><span class="toc-section-number">18.3.3</span> Assumptions of Spearman rank correlation</a></li>
<li><a href="rankcorr.html#conduct_spearman" id="toc-conduct_spearman"><span class="toc-section-number">18.3.4</span> Conduct the test</a></li>
<li><a href="rankcorr.html#spear_conclude" id="toc-spear_conclude"><span class="toc-section-number">18.3.5</span> Concluding statement</a></li>
</ul></li>
</ul></li>
<li><a href="creating-tables-in-r-markdown.html#creating-tables-in-r-markdown" id="toc-creating-tables-in-r-markdown">Creating tables in R Markdown</a>
<ul>
<li><a href="tables-packages.html#tables_packages" id="toc-tables_packages"><span class="toc-section-number">18.4</span> Load packages and import data</a>
<ul>
<li><a href="tables-packages.html#skim_tables" id="toc-skim_tables"><span class="toc-section-number">18.4.1</span> Formatting output from the <code>skimr</code> package</a></li>
<li><a href="tables-packages.html#stats_nicetable" id="toc-stats_nicetable"><span class="toc-section-number">18.4.2</span> A nicely formatted table of descriptive statistics</a></li>
</ul></li>
</ul></li>
<li><a href="checking-assumptions-and-data-transformations.html#checking-assumptions-and-data-transformations" id="toc-checking-assumptions-and-data-transformations">Checking assumptions and data transformations</a>
<ul>
<li><a href="assumptions-packages-data.html#assumptions_packages_data" id="toc-assumptions_packages_data"><span class="toc-section-number">18.5</span> Load packages and import data</a></li>
<li><a href="checknorm-assum.html#checknorm_assum" id="toc-checknorm_assum"><span class="toc-section-number">18.6</span> Checking the normality assumption</a>
<ul>
<li><a href="checknorm-assum.html#quantile_plots" id="toc-quantile_plots"><span class="toc-section-number">18.6.1</span> Normal quantile plots</a></li>
<li><a href="checknorm-assum.html#shapirottest" id="toc-shapirottest"><span class="toc-section-number">18.6.2</span> Shapiro-Wilk test for normality</a></li>
</ul></li>
<li><a href="levenetest.html#levenetest" id="toc-levenetest"><span class="toc-section-number">18.7</span> Checking the equal-variance assumption</a></li>
<li><a href="transform.html#transform" id="toc-transform"><span class="toc-section-number">18.8</span> Data transformations</a>
<ul>
<li><a href="transform.html#log_transform" id="toc-log_transform"><span class="toc-section-number">18.8.1</span> Log-transform</a></li>
<li><a href="transform.html#zeroes" id="toc-zeroes"><span class="toc-section-number">18.8.2</span> Dealing with zeroes</a></li>
<li><a href="transform.html#logbases" id="toc-logbases"><span class="toc-section-number">18.8.3</span> Log bases</a></li>
<li><a href="transform.html#back_transform" id="toc-back_transform"><span class="toc-section-number">18.8.4</span> Back-transforming log data</a></li>
<li><a href="transform.html#logit_transform" id="toc-logit_transform"><span class="toc-section-number">18.8.5</span> Logit transform</a></li>
<li><a href="transform.html#logit_back" id="toc-logit_back"><span class="toc-section-number">18.8.6</span> Back-transforming logit data</a></li>
<li><a href="transform.html#when_back" id="toc-when_back"><span class="toc-section-number">18.8.7</span> When to back-transform?</a></li>
</ul></li>
</ul></li>
<li><a href="visual-markdown-editor.html#visual-markdown-editor" id="toc-visual-markdown-editor">Visual Markdown Editor</a>
<ul>
<li><a href="a-more-familiar-editing-environment.html#a-more-familiar-editing-environment" id="toc-a-more-familiar-editing-environment">A more familiar editing environment</a></li>
</ul></li>
<li><a href="common-errors-and-their-solutions.html#common-errors-and-their-solutions" id="toc-common-errors-and-their-solutions">Common errors and their solutions</a>
<ul>
<li><a href="google-can-help.html#google-can-help" id="toc-google-can-help">Google can help</a></li>
<li><a href="rtools-required-during-install.html#rtools-required-during-install" id="toc-rtools-required-during-install">Rtools required during install</a></li>
<li><a href="could-not-find-function.html#could-not-find-function" id="toc-could-not-find-function">Could not find function</a></li>
<li><a href="there-is-no-package.html#there-is-no-package" id="toc-there-is-no-package">There is no package</a></li>
<li><a href="trying-to-use-cran-without-setting-a-mirror.html#trying-to-use-cran-without-setting-a-mirror" id="toc-trying-to-use-cran-without-setting-a-mirror">Trying to use CRAN without setting a mirror</a></li>
<li><a href="pdf-latex-is-not-found.html#pdf-latex-is-not-found" id="toc-pdf-latex-is-not-found">PDF Latex is not found</a></li>
<li><a href="error-in-parse.html#error-in-parse" id="toc-error-in-parse">Error in parse</a></li>
<li><a href="no-such-file-or-directory-exists.html#no-such-file-or-directory-exists" id="toc-no-such-file-or-directory-exists">No such file or directory exists</a></li>
<li><a href="messy-output-when-loading-packages.html#messy-output-when-loading-packages" id="toc-messy-output-when-loading-packages">Messy output when loading packages</a></li>
<li><a href="unused-argument.html#unused-argument" id="toc-unused-argument">Unused argument</a></li>
<li><a href="object-not-found.html#object-not-found" id="toc-object-not-found">Object not found</a></li>
<li><a href="figure-caption-doesnt-show-up-below-figure-in-knitted-document.html#figure-caption-doesnt-show-up-below-figure-in-knitted-document" id="toc-figure-caption-doesnt-show-up-below-figure-in-knitted-document">Figure caption doesn’t show up below figure in knitted document</a></li>
<li><a href="filename-directory-name-or-volume-label-syntax-is-incorrect.html#filename-directory-name-or-volume-label-syntax-is-incorrect" id="toc-filename-directory-name-or-volume-label-syntax-is-incorrect">Filename, directory name, or volume label syntax is incorrect</a></li>
<li><a href="installing-packages-there-is-a-binary-version-available.html#installing-packages-there-is-a-binary-version-available" id="toc-installing-packages-there-is-a-binary-version-available">Installing packages: there is a binary version available</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorials for BIOL202: Introduction to Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hyp_example" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> An hypothesis test example</h2>
<p>When defending territories along streams, males of the damselfly species <em>Calopteryx maculata</em> (pictured <a href="https://en.wikipedia.org/wiki/Ebony_jewelwing#/media/File:Ebony_Jewelwing,_male,_Gatineau_Park.jpg">here</a>) often battle intruders in the air, flying around and around in circles with their foe for minutes at a time. No one knows whether these battles are flown in a consistent direction, i.e. predominantly clockwise or counter-clockwise, as would be expected if the damselflies exhibited a form of “handedness”, like many animals do.</p>
<p>A researcher was curious about this because he had worked with these damselflies for years and witnessed many territorial bouts (see exmaple research <a href="http://www.nrcresearchpress.com/doi/abs/10.1139/z00-130#.WdFv0GKPKJU">here</a>).</p>
<p>The researcher conducted a study (fictional) in which he video-recorded 20 male damselflies defending territories (all randomly sampled from a population), and determined the predominant direction of flight during circular flight battles. One battle per damselfly was recorded, and each battle was known to involve a unique combattant.</p>
<p>He found that in 17 out of 20 bouts the damselflies flew in the counter-clockwise direction.</p>
<p>Should this result be considered evidence of handedness in this population?</p>
<hr />
<p>For this example, we’ll use the imported <code>damselfly</code> dataset, which includes the single categorical variable of interest “direction”, and there are two categories: “clockwise” and “counter_clockwise”.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="hyp-example.html#cb148-1" aria-hidden="true" tabindex="-1"></a>damselfly</span></code></pre></div>
<pre><code>## # A tibble: 20 × 1
##    direction        
##    &lt;chr&gt;            
##  1 clockwise        
##  2 counter_clockwise
##  3 counter_clockwise
##  4 clockwise        
##  5 counter_clockwise
##  6 counter_clockwise
##  7 counter_clockwise
##  8 counter_clockwise
##  9 counter_clockwise
## 10 counter_clockwise
## 11 counter_clockwise
## 12 clockwise        
## 13 counter_clockwise
## 14 counter_clockwise
## 15 counter_clockwise
## 16 counter_clockwise
## 17 counter_clockwise
## 18 counter_clockwise
## 19 counter_clockwise
## 20 counter_clockwise</code></pre>
<hr />
<div id="follow_hyp_steps" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Following the steps to hypothesis testing</h3>
<p>For the damselfly example, we have <em>n</em> = 20 <strong>random trials</strong>, each of which has two possible outcomes: clockwise battle or counter-clockwise battle. This conforms to the expectations of a <strong>binomial test</strong>, for which the <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Binomial-distribution"><em>binomial distribution</em></a> is used to generate the appropriate <strong>null distribution</strong>. We’ll learn about the binomial test in a later tutorial.</p>
<p>For the present tutorial, we’re going to generate a null distribution via simulation.</p>
<p>To do this, we need to consider what our “null expectation” is, i.e. if there was truly no handedness among the damselflies.</p>
<p>Our null expectation is that clockwise and counter-clockwise battles would occur with equal frequency. In other words, if we focus on counter-clockwise battles as the category of interest, then on average - across many, many battles - we’d expect those to make up <span class="math inline">\(p_0 = 0.5\)</span> of the battles. This is just like flipping a fair coin: over the long run (i.e. over many, many coin flips), we’d expect heads to make up half the outcomes, i.e. <span class="math inline">\(p_0 = 0.5\)</span>.</p>
<p>We can now specify our <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_A\)</span>:</p>
<p><strong>H<sub>0</sub></strong>: The proportion of damselfly battles in the population flown in the counter-clockwise direction is 0.5 (<span class="math inline">\(p_0 = 0.5\)</span>)</p>
<p><strong>H<sub>A</sub></strong>: The proportion of damselfly battles in the population flown in the counter-clockwise direction is not 0.5 (<span class="math inline">\(p_0 \ne 0.5\)</span>)</p>
<p>We’ll set <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>Although our <span class="math inline">\(H_0\)</span> makes a specific statement about a <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Proportion">proportion</a> (<span class="math inline">\(p_0\)</span>), our <em>test statistic</em> will actually be the <strong>number of battles that occurred in a counter-clockwise direction</strong>. Of course, we can re-express this number as a proportion, but convention is that we use the number (frequency) instead.</p>
<p>As indicated by the <strong>H<sub>A</sub></strong> statement, we’ll use a 2-tailed <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Alternative-hypothesis">alternative hypothesis</a> because we have no reason to exclude the possibility that clockwise battles are in fact more predominant.</p>
</div>
<div id="sim_null" class="section level3" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Simulating a “null distribution”</h3>
<p>For our damselfly example, we can easily simulate the random trials (20 territorial flight battles, each yielding one of 2 outcomes) by using what we learned in the previous <a href="estimation.html#estimation">tutorial</a> about simulations in R.</p>
<p>First, we’ll create a tibble object called “null_options” that holds a categorical variable “direction” with two categories, “clockwise” and “counter_clockwise”:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="hyp-example.html#cb150-1" aria-hidden="true" tabindex="-1"></a>null_options <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">direction =</span> <span class="fu">c</span>(<span class="st">&quot;clockwise&quot;</span>, <span class="st">&quot;counter_clockwise&quot;</span>))</span></code></pre></div>
<p>Have a look at the resulting object:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="hyp-example.html#cb151-1" aria-hidden="true" tabindex="-1"></a>null_options</span></code></pre></div>
<pre><code>## # A tibble: 2 × 1
##   direction        
##   &lt;chr&gt;            
## 1 clockwise        
## 2 counter_clockwise</code></pre>
<p>Now we can use the <code>rep_slice_sample</code> function from the <code>infer</code> package (which we learned about in the last <a href="estimation.html#estimation">tutorial</a>) to simulate a large number of repetitions of our <em>n</em> = 20 random trials. The number of repetitions is governed by the <em>reps</em> argument.</p>
<p>We’ll set the seed first, to ensure everyone gets the same result for this initial demonstration repetition.</p>
<p>Let’s start with a single repetition of <em>n</em> = 20 random trials. We’ll explain the code after:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="hyp-example.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">199</span>)</span>
<span id="cb153-2"><a href="hyp-example.html#cb153-2" aria-hidden="true" tabindex="-1"></a>num.reps <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb153-3"><a href="hyp-example.html#cb153-3" aria-hidden="true" tabindex="-1"></a>null_options <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="hyp-example.html#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep_slice_sample</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">reps =</span> num.reps) <span class="sc">%&gt;%</span></span>
<span id="cb153-5"><a href="hyp-example.html#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(direction)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
## # Groups:   replicate [1]
##   replicate direction             n
##       &lt;int&gt; &lt;chr&gt;             &lt;int&gt;
## 1         1 clockwise             9
## 2         1 counter_clockwise    11</code></pre>
<ul>
<li>We first set the seed (using integer 199 here; arbitrarily chosen)</li>
<li>Next we create an object “num.reps” that is simply one number: the number of replications we wish to run (here, 1)</li>
<li>We tell R we’re using the “null_options” object (created previously) for input into the subsequent lines, using the pipe (%&gt;%) to continue the code</li>
<li>We use the <code>rep_slice_sample</code> function, setting the number of trials <em>n</em> to 20, and ensuring that we use sampling with replacement here (“replace = T”) because our “null_options” object has only two observations to sample from, and we need 20 total;</li>
<li>You can think of the “weight_by” argument as a way to control the relative <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#Probability">probability</a> of sampling each of the rows in the input tibble (here, the “null_options” tibble). Here we provide two values (0.5, 0.5), specifying that we want each of the two rows in the tibble to have equal likelihood of being sampled at random. This corresponds to what we want for our null expectation, and for the generation of the null distribution</li>
<li>The last argument to the <code>rep_slice_sample</code> function is “reps = num.reps”, using our created object to tell R that we want only one repetition of the 20 trials</li>
<li>In the last line of code we use the <code>count</code> function to tally the number of observations belonging to each of the two categories in the “direction” variable</li>
</ul>
<p>So you see that the output above is a tibble with 3 variables: “replicate”, “direction”, and “n”.</p>
<p>We’re specifically interested in the number of times (the frequency) out of the 20 trials that the damselfly battle was predominantly “counter_clockwise” (what we consider a “success”). So in our first repetition here, 11 of the trials were predominantly in the counter-clockwise direction.</p>
<p>Now what we need to do is run many thousands of repetitions (we’ll do 10^{5}), and each time tally the number of battles (out of the 20 trials) in which the direction was counter-clockwise.</p>
<p>This will generate a reasonable approximation of a <strong>null distribution</strong> for our study.</p>
<p>After the setting the seed, we create an object that simply holds the number of replications we wish to run.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="hyp-example.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">199</span>)</span>
<span id="cb155-2"><a href="hyp-example.html#cb155-2" aria-hidden="true" tabindex="-1"></a>num.reps <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb155-3"><a href="hyp-example.html#cb155-3" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> null_options <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="hyp-example.html#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep_slice_sample</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">weight_by =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">reps =</span> num.reps) <span class="sc">%&gt;%</span></span>
<span id="cb155-5"><a href="hyp-example.html#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(direction) <span class="sc">%&gt;%</span></span>
<span id="cb155-6"><a href="hyp-example.html#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(direction <span class="sc">==</span> <span class="st">&quot;counter_clockwise&quot;</span>)</span></code></pre></div>
<p>In the above code chunk, we:</p>
<ul>
<li>assign our output to a new object called “dull_distribution”</li>
<li>We changed the “reps” argument for the <code>rep_slice_sample</code> function to 10^{5} (all other arguments stay the same).</li>
<li>We use the <code>count</code> function to tally the number of observations belonging to each of the two categories in the “direction” variable</li>
<li>We then <code>filter</code> the output from our sampling to the rows with the “direction” variable equal to “counter_clockwise”</li>
</ul>
<p>Let’s look at the resulting object:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="hyp-example.html#cb156-1" aria-hidden="true" tabindex="-1"></a>null_distribution</span></code></pre></div>
<pre><code>## # A tibble: 100,000 × 3
## # Groups:   replicate [100,000]
##    replicate direction             n
##        &lt;int&gt; &lt;chr&gt;             &lt;int&gt;
##  1         1 counter_clockwise    11
##  2         2 counter_clockwise     9
##  3         3 counter_clockwise     8
##  4         4 counter_clockwise    11
##  5         5 counter_clockwise    13
##  6         6 counter_clockwise     9
##  7         7 counter_clockwise     9
##  8         8 counter_clockwise    12
##  9         9 counter_clockwise     6
## 10        10 counter_clockwise     9
## # … with 99,990 more rows</code></pre>
<p>We have a tibble with the number of rows equal to the number of replications we performed (100000), three variables (“replicate”, “direction”, and “n”), and the key information are the numbers in the “n” variable. These represent the number of battles (out of 20) that were predominantly in the counter-clockwise direction.</p>
<p>We can now create a histogram of these data, thus producing an approximation of a “null distribution”.</p>
<p>The only difference here, compared to previous times we’ve created histograms, is that we add the <code>after_stat(density)</code> argument to the <code>aes</code> part of the <code>ggplot</code> function. This tells R to display the relative frequency (= probability density) rather than the raw counts on the y-axis. Notice we also use “binwidth = 1”, because we want to see a bar for each potential outcome (0 through 20).</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="hyp-example.html#cb158-1" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="hyp-example.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb158-3"><a href="hyp-example.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">&quot;lightgrey&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb158-4"><a href="hyp-example.html#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb158-5"><a href="hyp-example.html#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Number of counter-clockwise battles&quot;</span>) <span class="sc">+</span></span>
<span id="cb158-6"><a href="hyp-example.html#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Relative frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb158-7"><a href="hyp-example.html#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-56"></span>
<img src="BIOL202_files/figure-html/unnamed-chunk-56-1.png" alt="Approximate null distribution for the damselfly study, with n = 20 trials, and probability of success = 0.5 in each trial. Data are from 100000 repetitions." width="480" />
<p class="caption">
Figure 12.1: Approximate null distribution for the damselfly study, with n = 20 trials, and probability of success = 0.5 in each trial. Data are from 100000 repetitions.
</p>
</div>
<p>The null distribution above shows us that if the null hypothesis was true, the most probable outcome would be 10 counter-clockwise battles out of 20. But other outcomes are of course possible, with decreasing probability towards zero and twenty.</p>
</div>
<div id="calc_p" class="section level3" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Calculating the <em>P</em>-value</h3>
<p>The <a href="https://ubco-biology.github.io/Procedures-and-Guidelines/glossary#P-value"><strong><em>P</em>-value</strong></a> is defined as the probability of observing an outcome as extreme or more extreme as the observed value of the test statistic, if the null hypothesis were true.</p>
<p>In our damselfly study, we observed 17 out of 20 battles to be in the counter-clockwise direction.</p>
<p>We can calculate a <strong><em>P</em>-value</strong> as follows:</p>
<ul>
<li>first calculate the fraction of the 10^{5} values in our null distribution that are equal to or greater than our observed test statistic value (here, 17)</li>
<li>if we have a 2-tailed alternative hypothesis, then we also need to calculate the fraction of the 10^{5} values in our null distribution that are less than or equal to 3, which is the mirror number to 17 in the opposite side of the distribution.</li>
</ul>
<div class="note">
<p><strong>NOTE</strong>
Although our approximate null distribution that we created looks quite symmetrical, it’s best not to assume it is (because recall that we generated this via simulation). Therefore we don’t simply multiply the first value we calculate above by two. In future tutorials you’ll learn how to calculate <strong><em>P</em>-values</strong> using built-in R functions and theoretical probability distributions.</p>
</div>
<p>In the <a href="coding-basics.html#coding_basics">Introductory R Tutorials</a> you learned how to use <strong>logical comparison operators</strong> such as <code>&gt;</code> and <code>&lt;=</code>. We’ll use these here.</p>
<p>Let’s find out how many values within the variable <code>n</code> in our <code>null_distribution</code> tibble are less than or equal to 3, or greater than or equal to 17:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="hyp-example.html#cb159-1" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="hyp-example.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">|</span> n <span class="sc">&gt;=</span> <span class="dv">17</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="hyp-example.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>() </span></code></pre></div>
<pre><code>## [1] 254</code></pre>
<p>This code uses the <code>filter</code> function to return only the rows that meet the condition specified: the “n” variable value less than or equal to 3, OR (using the “|” symbol) greater than or equal to 17.</p>
<p>The <code>nrow</code> function then simply counts the number of rows in the resulting (filtered) tibble.</p>
<p>We see that among the 10^{5} replications we ran, 254 yielded outcomes in which 3 or fewer, or 17 or more out of 20 battles were in the counter-clockwise direction.</p>
<p>To calculate the <em>P</em>-value, we need to divide the 254 by the total number of reps that we conducted, here 10^{5}.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="hyp-example.html#cb161-1" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="sc">%&gt;%</span></span>
<span id="cb161-2"><a href="hyp-example.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">|</span> n <span class="sc">&gt;=</span> <span class="dv">17</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="hyp-example.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>() <span class="sc">/</span> num.reps</span></code></pre></div>
<pre><code>## [1] 0.00254</code></pre>
<p>So the <strong><em>P</em>-value</strong> associated with our observed test statistic is 0.00254.</p>
</div>
<div id="concluding_statement" class="section level3" number="12.3.4">
<h3><span class="header-section-number">12.3.4</span> Writing a concluding statement</h3>
<p>It is important to write a concluding statement that talks about the actual findings of the study. For example:</p>
<p>In their territorial bouts, the damselflies flew in a counter-clockwise direction significantly more than expected (17 counter-clockwise flights out of <em>n</em> = 20 trials; <em>P</em>-value = 0.003). This is consistent with the idea that there is “handedness” in this population of <em>C. maculata</em>.</p>
<p>It is also crucial that you report the sample size (here, number of random trials), the value of the observed test statistic (here 17), and the associated <strong><em>P</em>-value</strong>. Note we rounded the <strong><em>P</em>-value</strong> to three decimal places.</p>
<p>When we learn new types of statistical test, we’ll adjust our concluding statements accordingly.</p>
<ol style="list-style-type: decimal">
<li>Using this tutorial as a guide, try to repeat all the steps of a hypothesis test for Example 6.2 in the text book (concerning handedness in toads).</li>
</ol>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="hyp-steps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="single-cat.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BIOL202.pdf", "BIOL202.epub"],
"toc": {
"collapse": "section",
"scroll_highight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
